<span data-ttu-id="eb8ba-101">Il rivenditore online per cui si sta lavorando prevede di espandersi in una nuova area geografica in un prossimo futuro.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-101">The online retailer that you work for plans to expand to a new geographical area in the near future.</span></span> <span data-ttu-id="eb8ba-102">Questo passaggio aumenterà la base clienti e il volume delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-102">This move will increase your customer base and transaction volume.</span></span> <span data-ttu-id="eb8ba-103">È necessario assicurarsi che il database sia predisposto per gestire l'espansione secondo le necessità.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-103">You must ensure that your database is equipped to handle expansion whenever required.</span></span>

<span data-ttu-id="eb8ba-104">Disporre di una strategia di partizione assicura che nel momento in cui il database dovrà aumentare le sue dimensioni, sarà in grado di farlo facilmente e continuare a eseguire transazioni e query efficienti.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-104">Having a partition strategy ensures that when your database needs to grow, it can do so easily and continue to perform efficient queries and transactions.</span></span>

## <a name="what-is-a-partition-strategy"></a><span data-ttu-id="eb8ba-105">Cosa si intende per strategia di partizione?</span><span class="sxs-lookup"><span data-stu-id="eb8ba-105">What is a partition strategy?</span></span>

<span data-ttu-id="eb8ba-106">Se si continua ad aggiungere nuovi dati a un singolo server o a una singola partizione, potrebbe esaurirsi lo spazio.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-106">If you continue to add new data to a single server or a single partition, it will eventually run out of space.</span></span> <span data-ttu-id="eb8ba-107">Per prepararsi a ciò, è necessaria una strategia di partizionamento di **scalabilità orizzontale** e non verticale.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-107">To prepare for this, you need a partitioning strategy to **scale out** instead of up.</span></span> <span data-ttu-id="eb8ba-108">La scalabilità orizzontale consente di aggiungere altre partizioni nel database quando necessarie all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-108">Scaling out is also called horizontal scaling, and it enables you to add more partitions to your database as your application needs them.</span></span>

<span data-ttu-id="eb8ba-109">La strategia di partizione e scalabilità orizzontale in Azure Cosmos DB è determinata dalla chiave di partizione, ovvero un valore impostato durante la creazione di una raccolta.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-109">The partition and scale-out strategy in Azure Cosmos DB is driven by the partition key, which is a value set when you create a collection.</span></span> <span data-ttu-id="eb8ba-110">Dopo aver impostato la chiave di partizione, non può essere modificata senza ricreare la raccolta, quindi selezionare la chiave di partizione corretta è una decisione importante da eseguire all'inizio del processo di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-110">Once the partition key is set, it cannot be changed without recreating the collection, so selecting the right partition key is an important decision to make early in your development process.</span></span>  

<span data-ttu-id="eb8ba-111">In questa unità, si apprenderà come scegliere la chiave di partizione più adatta a uno scenario e che potrà sfruttare la scalabilità automatica che Azure Cosmos DB è in grado di offrire.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-111">In this unit, you will learn how to choose a partition key that's right for your scenario and will take advantage of the autoscaling that Azure Cosmos DB can do for you.</span></span>

## <a name="partition-key-basics"></a><span data-ttu-id="eb8ba-112">Notizie fondamentali sulla chiave di partizione</span><span class="sxs-lookup"><span data-stu-id="eb8ba-112">Partition key basics</span></span>

<span data-ttu-id="eb8ba-113">Una chiave di partizione rappresenta un valore nel database che viene spesso sottoposto a query.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-113">A partition key represent a value in your database that's frequently queried.</span></span> <span data-ttu-id="eb8ba-114">In uno scenario di vendita online, usare il valore UserID o ProductID come chiave di partizione è una buona scelta.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-114">So in an online retail scenario, using the UserID or ProductID value as the partition key is a good choice.</span></span> <span data-ttu-id="eb8ba-115">Il valore UserID è un'ottima scelta, poiché l'applicazione deve spesso recuperare le impostazioni di personalizzazione, il carrello, la cronologia degli ordini e le informazioni per l'utente, solo per citarne alcuni.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-115">UserID is a good choice, as your application frequently needs to retrieve the personalization settings, shopping cart, order history, and profile information for the user, just to name a few.</span></span> <span data-ttu-id="eb8ba-116">Anche il valore ProductID è un'ottima scelta, poiché l'applicazione deve eseguire query su livelli di inventario, costi di spedizione, opzioni di colore, posizione dei negozi e molto altro.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-116">ProductID is also a good choice, as your application needs to query inventory levels, shipping costs, color options, warehouse locations, and more.</span></span>

<span data-ttu-id="eb8ba-117">Una chiave di partizione deve tendere a distribuire le operazioni tra il database.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-117">A partition key should aim to distribute operations across the database.</span></span> <span data-ttu-id="eb8ba-118">L'obiettivo è distribuire le richieste nel tentativo di evitare partizioni critiche.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-118">You want to distribute requests in an effort to avoid hot partitions.</span></span> <span data-ttu-id="eb8ba-119">Una partizione critica è una partizione singola che riceve molte più richieste rispetto alle altre, che possono creare un collo di bottiglia della velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-119">A hot partition is a single partition that receives many more requests than the others, which can create a throughput bottleneck.</span></span> <span data-ttu-id="eb8ba-120">Ad esempio, per l'applicazione di e-commerce, l'ora corrente sarebbe una pessima scelta per una chiave di partizione, perché tutti i dati in ingresso sarebbero indirizzati a una singola chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-120">For example, for your e-commerce application, the current time would be a poor choice of partition key, because all the incoming data would go to a single partition key.</span></span> <span data-ttu-id="eb8ba-121">I valori UserID o ProductID sono più indicati, dal momento che tutti gli utenti nel sito aggiungerebbero e aggiornerebbero probabilmente il carrello o le informazioni del profilo a circa la stessa frequenza, che distribuisce le letture e le scritture in tutte le partizioni dell'utente.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-121">UserID or ProductID would be better, as all the users on your site would likely be adding and updating their shopping cart or profile information at about the same frequency, which distributes the reads and writes across all the user partitions.</span></span> <span data-ttu-id="eb8ba-122">Allo stesso modo, gli aggiornamenti ai dati dei prodotti sarebbero probabilmente distribuiti abbastanza uniformemente, rendendo il valore ProductID una scelta di chiave di partizione efficace.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-122">Likewise, updates to product data would also likely be fairly evenly distributed, making ProductID a good partition key choice.</span></span>

<span data-ttu-id="eb8ba-123">Ogni chiave di partizione ha uno spazio di archiviazione massimo di 10 GB, ovvero le dimensioni di una partizione fisica in Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-123">Each partition key has a maximum storage space of 10 GB, which is the size of one physical partition in Azure Cosmos DB.</span></span> <span data-ttu-id="eb8ba-124">Pertanto, se il singolo record UserID o ProductID è superiore a 10 GB, si pensi a usare invece una chiave composta in modo che ogni record sia inferiore.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-124">So if your single UserID or ProductID record is going to be larger than 10 GB, think about using a composite key instead so that each record is smaller.</span></span> <span data-ttu-id="eb8ba-125">Un esempio di una chiave composta sarebbe UserID-data, che sarà simile a CustomerName-08072018.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-125">An example of a composite key would be UserID-date, which would look like CustomerName-08072018.</span></span> <span data-ttu-id="eb8ba-126">Questo approccio consentirebbe di creare una nuova partizione per ogni giorno in cui un utente visita il sito.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-126">This composite key approach would enable you to create a new partition for each day a user visited the site.</span></span>

## <a name="best-practices"></a><span data-ttu-id="eb8ba-127">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="eb8ba-127">Best practices</span></span>

<span data-ttu-id="eb8ba-128">Quando si tenta di determinare la chiave di partizione corretta e la soluzione non è ovvia, ecco alcuni suggerimenti da tenere presenti.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-128">When you're trying to determine the right partition key and the solution isn't obvious, here are a few tips to keep in mind.</span></span>

* <span data-ttu-id="eb8ba-129">Non si temi di disporre di un numero eccessivo di chiavi di partizione.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-129">Don’t be afraid of having too many partition keys.</span></span> <span data-ttu-id="eb8ba-130">Più sono le chiavi di partizione di cui si dispone, maggiore è la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-130">The more partition keys you have, the more scalability you have.</span></span>

* <span data-ttu-id="eb8ba-131">Per determinare la migliore chiave di partizione per un carico di lavoro con intensa attività di lettura, esaminare le migliori 3-5 query che si intende usare.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-131">To determine the best partition key for a read-heavy workload, review the top three to five queries you plan on using.</span></span> <span data-ttu-id="eb8ba-132">Il valore incluso più di frequente nella clausola WHERE è un buon candidato per la chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-132">The value most frequently included in the WHERE clause is a good candidate for the partition key.</span></span>

* <span data-ttu-id="eb8ba-133">Per carichi di lavoro con intensa attività di scrittura, è necessario capire le esigenze di un carico di lavoro transazionale, poiché la chiave di partizione è l'ambito delle transazioni in più documenti.</span><span class="sxs-lookup"><span data-stu-id="eb8ba-133">For write-heavy workloads, you'll need to understand the transactional needs of your workload, because the partition key is the scope of multi-document transactions.</span></span>
