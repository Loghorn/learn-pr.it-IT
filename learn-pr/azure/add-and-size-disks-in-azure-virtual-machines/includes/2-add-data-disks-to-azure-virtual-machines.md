<span data-ttu-id="060a8-101">Analogamente a qualsiasi altro computer, le macchine virtuali in Azure usano i dischi come posizioni per archiviare un sistema operativo, le applicazioni e i dati.</span><span class="sxs-lookup"><span data-stu-id="060a8-101">Just like any other computer, virtual machines in Azure use disks as a place to store an operating system, applications, and data.</span></span> <span data-ttu-id="060a8-102">Questi dischi vengono detti dischi rigidi virtuali (VHD).</span><span class="sxs-lookup"><span data-stu-id="060a8-102">These disks are called virtual hard disks (VHDs).</span></span>

<span data-ttu-id="060a8-103">Si supponga di avere creato una macchina virtuale (VM) in Azure che ospiterà il database dei casi archiviati usato dallo studio legale.</span><span class="sxs-lookup"><span data-stu-id="060a8-103">Suppose you have created a virtual machine (VM) in Azure, which will host the database of case histories that your law firm relies on.</span></span> <span data-ttu-id="060a8-104">Una configurazione dei dischi ben progettata è fondamentale per garantire buone prestazioni e resilienza per SQL Server.</span><span class="sxs-lookup"><span data-stu-id="060a8-104">A well-designed disk configuration is fundamental to good performance and resilience for SQL Server.</span></span>

<span data-ttu-id="060a8-105">In questa unità si apprenderà come scegliere i valori di configurazione appropriati per i dischi e come collegare i dischi a una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-105">In this unit, you'll learn how to choose the right configuration values for your disks and how to attach those disks to a VM.</span></span>

## <a name="how-disks-are-used-by-vms"></a><span data-ttu-id="060a8-106">Modalità d'uso dei dischi da parte delle macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="060a8-106">How disks are used by VMs</span></span>

<span data-ttu-id="060a8-107">Le macchine virtuali usano i dischi per tre scopi diversi:</span><span class="sxs-lookup"><span data-stu-id="060a8-107">VMs use disks for three different purposes:</span></span>

- <span data-ttu-id="060a8-108">**Archiviazione del sistema operativo**.</span><span class="sxs-lookup"><span data-stu-id="060a8-108">**Operating system storage**.</span></span> <span data-ttu-id="060a8-109">Ogni macchina virtuale include un disco che archivia il sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="060a8-109">Every VM includes one disk that stores the operating system.</span></span> <span data-ttu-id="060a8-110">Questa unità è registrata come unità SATA ed etichettata come unità C: in Windows e montata in "/" nei sistemi operativi di tipo Unix.</span><span class="sxs-lookup"><span data-stu-id="060a8-110">This drive is registered as a SATA drive and labeled as the C: drive in Windows and mounted at "/" in Unix-like operating systems.</span></span> <span data-ttu-id="060a8-111">Ha una capacità massima di 2048 gigabyte (GB) e il relativo contenuto è derivato dall'immagine della macchina virtuale usata per creare la macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-111">It has a maximum capacity of 2048 gigabytes (GB), and its content is taken from the VM image you used to create the VM.</span></span>
- <span data-ttu-id="060a8-112">**Archiviazione temporanea**.</span><span class="sxs-lookup"><span data-stu-id="060a8-112">**Temporary storage**.</span></span> <span data-ttu-id="060a8-113">Ogni macchina virtuale include un disco rigido virtuale temporaneo usato per i file di paging e di scambio.</span><span class="sxs-lookup"><span data-stu-id="060a8-113">Every VM includes a temporary VHD that is used for page and swap files.</span></span> <span data-ttu-id="060a8-114">I dati in questa unità potrebbero andare persi durante un evento di manutenzione o un'operazione di ridistribuzione.</span><span class="sxs-lookup"><span data-stu-id="060a8-114">Data on this drive may be lost during a maintenance event or redeployment.</span></span> <span data-ttu-id="060a8-115">In una macchina virtuale Windows l'unità è etichettata come unità D: per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="060a8-115">The drive is labeled as D: on a Windows VM by default.</span></span> <span data-ttu-id="060a8-116">Non usare questa unità per archiviare dati importanti che non si vogliono perdere.</span><span class="sxs-lookup"><span data-stu-id="060a8-116">Do not use this drive to store important data that you do not want to lose.</span></span>
- <span data-ttu-id="060a8-117">**Archiviazione dei dati**.</span><span class="sxs-lookup"><span data-stu-id="060a8-117">**Data storage**.</span></span> <span data-ttu-id="060a8-118">Un disco dati è qualsiasi altro disco collegato a una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-118">A data disk is any other disk attached to a VM.</span></span> <span data-ttu-id="060a8-119">I dischi dati si usano per archiviare file, database e altri dati che è necessario salvare in modo permanente in caso di riavvio.</span><span class="sxs-lookup"><span data-stu-id="060a8-119">You use data disks to store files, databases, and any other data that you need to persist across reboots.</span></span> <span data-ttu-id="060a8-120">Alcune immagini di macchine virtuali includono dischi dati per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="060a8-120">Some VM images include data disks by default.</span></span> <span data-ttu-id="060a8-121">È anche possibile aggiungere ulteriori dischi dati fino al numero massimo specificato per la dimensione della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-121">You can also add additional data disks up to the maximum number specified by the size of the VM.</span></span> <span data-ttu-id="060a8-122">Ogni disco dati viene registrato come unità SCSI e ha una capacità massima di 4095 GB.</span><span class="sxs-lookup"><span data-stu-id="060a8-122">Each data disk is registered as a SCSI drive and has a max capacity of 4095 GB.</span></span> <span data-ttu-id="060a8-123">È possibile scegliere le lettere di unità o i punti di montaggio per le unità dati.</span><span class="sxs-lookup"><span data-stu-id="060a8-123">You can choose drive letters or mount points for your data drives.</span></span>

## <a name="storing-vhd-files"></a><span data-ttu-id="060a8-124">Archiviazione di file VHD</span><span class="sxs-lookup"><span data-stu-id="060a8-124">Storing VHD files</span></span>

<span data-ttu-id="060a8-125">In Azure i dischi rigidi virtuali vengono archiviati in un account di archiviazione di Azure come **BLOB di pagine**.</span><span class="sxs-lookup"><span data-stu-id="060a8-125">In Azure, VHDs are stored in an Azure storage account as **page blobs**.</span></span>

<span data-ttu-id="060a8-126">Questa tabella mostra i diversi tipi di account di archiviazione e gli oggetti che possono essere usati con ogni tipo.</span><span class="sxs-lookup"><span data-stu-id="060a8-126">This table shows the various kinds of storage accounts and which objects can be used with each.</span></span>

|<span data-ttu-id="060a8-127">**Tipo di account di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="060a8-127">**Type of storage account**</span></span>|<span data-ttu-id="060a8-128">**Standard per utilizzo generico**</span><span class="sxs-lookup"><span data-stu-id="060a8-128">**General-purpose standard**</span></span>|<span data-ttu-id="060a8-129">**Premium per utilizzo generico**</span><span class="sxs-lookup"><span data-stu-id="060a8-129">**General-purpose premium**</span></span>|<span data-ttu-id="060a8-130">**Archiviazione BLOB, livelli di accesso frequente e sporadico**</span><span class="sxs-lookup"><span data-stu-id="060a8-130">**Blob storage, hot and cool access tiers**</span></span>|
|-----|-----|-----|-----|
|<span data-ttu-id="060a8-131">**Servizi supportati**</span><span class="sxs-lookup"><span data-stu-id="060a8-131">**Services supported**</span></span>| <span data-ttu-id="060a8-132">Archiviazione BLOB di Azure, File di Azure, Archiviazione code di Azure</span><span class="sxs-lookup"><span data-stu-id="060a8-132">Azure Blob storage, Azure Files, Azure Queue storage</span></span> | <span data-ttu-id="060a8-133">Archiviazione BLOB</span><span class="sxs-lookup"><span data-stu-id="060a8-133">Blob storage</span></span> | <span data-ttu-id="060a8-134">Archiviazione BLOB</span><span class="sxs-lookup"><span data-stu-id="060a8-134">Blob storage</span></span>|
|<span data-ttu-id="060a8-135">**Tipi di BLOB supportati**</span><span class="sxs-lookup"><span data-stu-id="060a8-135">**Types of blobs supported**</span></span>|<span data-ttu-id="060a8-136">BLOB in blocchi, BLOB di pagine e BLOB di accodamento</span><span class="sxs-lookup"><span data-stu-id="060a8-136">Block blobs, page blobs, and append blobs</span></span> | <span data-ttu-id="060a8-137">BLOB di pagine</span><span class="sxs-lookup"><span data-stu-id="060a8-137">Page blobs</span></span> | <span data-ttu-id="060a8-138">BLOB in blocchi e BLOB di accodamento</span><span class="sxs-lookup"><span data-stu-id="060a8-138">Block blobs and append blobs</span></span>|

<span data-ttu-id="060a8-139">I BLOB di pagine sono supportati sia dall'archiviazione Standard che Premium per utilizzo generico.</span><span class="sxs-lookup"><span data-stu-id="060a8-139">Both General-purpose standard and premium storage support page blobs.</span></span> <span data-ttu-id="060a8-140">Scegliere un account di archiviazione Standard se il costo è di importanza primaria.</span><span class="sxs-lookup"><span data-stu-id="060a8-140">Choose a standard storage account if cost is your primary concern.</span></span> <span data-ttu-id="060a8-141">L'archiviazione Premium ha costi maggiori, ma garantirà anche un numero molto maggiore di operazioni di I/O al secondo (IOPS).</span><span class="sxs-lookup"><span data-stu-id="060a8-141">Premium storage will cost more, but will also deliver much higher I/O operations/sec (IOPS).</span></span> <span data-ttu-id="060a8-142">Se le prestazioni dei dati sono un requisito per la macchina virtuale, preferire l'archiviazione Premium.</span><span class="sxs-lookup"><span data-stu-id="060a8-142">If data performance is a requirement for your VM, prefer premium storage.</span></span>

## <a name="attach-data-disks-to-vms"></a><span data-ttu-id="060a8-143">Collegare i dischi dati alle macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="060a8-143">Attach data disks to VMs</span></span>

<span data-ttu-id="060a8-144">È possibile aggiungere dischi dati a una macchina virtuale in qualsiasi momento, collegando il disco alla macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-144">You can add data disks to a virtual machine at any time by attaching them to the VM.</span></span> <span data-ttu-id="060a8-145">Il collegamento di un disco associa il file VHD alla macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-145">Attaching a disk associates the VHD file with the VM.</span></span> 

<span data-ttu-id="060a8-146">Il disco rigido virtuale non può essere eliminato dall'archiviazione mentre è collegato.</span><span class="sxs-lookup"><span data-stu-id="060a8-146">The VHD can't be deleted from storage while it's attached.</span></span>

### <a name="attach-an-existing-data-disk-to-an-azure-vm"></a><span data-ttu-id="060a8-147">Collegare un disco dati esistente a una macchina virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="060a8-147">Attach an existing data disk to an Azure VM</span></span>

<span data-ttu-id="060a8-148">Si potrebbe già avere un disco rigido virtuale che archivia i dati da usare nella macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="060a8-148">You may already have a VHD that stores the data you want to use in your Azure VM.</span></span> <span data-ttu-id="060a8-149">Nello scenario dello studio legale, ad esempio, i dischi fisici potrebbero essere già stati convertiti in dischi rigidi virtuali in locale.</span><span class="sxs-lookup"><span data-stu-id="060a8-149">In our law firm scenario, for example,  perhaps you've already converted your physical disks to VHDs locally.</span></span> <span data-ttu-id="060a8-150">In questo caso, è possibile usare il cmdlet `Add-AzureRmVhd` di PowerShell per il caricamento nell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="060a8-150">In this case, you can use the PowerShell `Add-AzureRmVhd` cmdlet to upload it to the storage account.</span></span> <span data-ttu-id="060a8-151">Questo cmdlet è ottimizzato per il trasferimento di file VHD e consente di completare il caricamento più velocemente rispetto ad altri metodi.</span><span class="sxs-lookup"><span data-stu-id="060a8-151">This cmdlet is optimized for transferring VHD files and may complete the upload faster than other methods.</span></span> <span data-ttu-id="060a8-152">Il trasferimento viene completato usando più thread per garantire prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="060a8-152">The transfer is completed by using multiple threads for best performance.</span></span> <span data-ttu-id="060a8-153">Una volta caricato il disco rigido virtuale, è necessario collegarlo a una macchina virtuale esistente come disco dati.</span><span class="sxs-lookup"><span data-stu-id="060a8-153">Once the VHD has been uploaded, attach it to an existing VM as a data disk.</span></span> <span data-ttu-id="060a8-154">Questo approccio è ideale per distribuire i dati di tutti i tipi nelle macchine virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="060a8-154">This approach an excellent way to deploy data of all types to Azure VMs.</span></span> <span data-ttu-id="060a8-155">I dati sono automaticamente presenti nella macchina virtuale e non è necessario partizionare o formattare il nuovo disco.</span><span class="sxs-lookup"><span data-stu-id="060a8-155">The data is automatically present in the VM, and there's no need to partition or format the new disk.</span></span>

### <a name="attach-a-new-data-disk-to-an-azure-vm"></a><span data-ttu-id="060a8-156">Collegare un nuovo disco dati a una macchina virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="060a8-156">Attach a new data disk to an Azure VM</span></span>

<span data-ttu-id="060a8-157">È possibile usare il portale di Azure per aggiungere un nuovo disco dati vuoto a una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-157">You can use the Azure portal to add a new, empty data disk to a VM.</span></span> 

<span data-ttu-id="060a8-158">Questo processo creerà un file **VHD** come BLOB di pagine nell'account di archiviazione specificato e tale file VHD verrà collegato come disco dati alla macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="060a8-158">This process will create a **.vhd** file as a page blob in the storage account that you specify, and attach that .vhd file as a data disk to the VM.</span></span>

<span data-ttu-id="060a8-159">Per poter usare il nuovo disco rigido virtuale per archiviare i dati, è necessario inizializzarlo, partizionarlo e formattarlo.</span><span class="sxs-lookup"><span data-stu-id="060a8-159">Before you can use the new VHD to store data, you have to initialize, partition, and format the new disk.</span></span> <span data-ttu-id="060a8-160">Questi passaggi verranno eseguiti nell'esercizio successivo.</span><span class="sxs-lookup"><span data-stu-id="060a8-160">We'll practice these steps in the next exercise.</span></span>

<span data-ttu-id="060a8-161">Nei server fisici locali i dati vengono archiviati in dischi rigidi fisici.</span><span class="sxs-lookup"><span data-stu-id="060a8-161">In physical on-premises servers, you store data on physical hard disks.</span></span> <span data-ttu-id="060a8-162">I dati in una macchina virtuale di Azure vengono archiviati in dischi rigidi virtuali.</span><span class="sxs-lookup"><span data-stu-id="060a8-162">You store data in an Azure virtual machine (VM) on virtual hard disks (VHDs).</span></span> <span data-ttu-id="060a8-163">Questi dischi rigidi virtuali vengono archiviati come BLOB di pagine negli account di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="060a8-163">These VHDs are stored as page blobs in Azure storage accounts.</span></span> <span data-ttu-id="060a8-164">Ad esempio, quando si esegue la migrazione in Azure del database dei casi archiviati dello studio legale, è necessario creare i dischi rigidi virtuali in cui verranno salvati i file del database.</span><span class="sxs-lookup"><span data-stu-id="060a8-164">For example, when you migrate your law firm's database of case histories to Azure, you must create VHDs where the database files will be saved.</span></span>
