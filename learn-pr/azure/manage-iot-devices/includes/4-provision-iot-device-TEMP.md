<span data-ttu-id="c18b7-101">Ora che si sono acquisite le conoscenze necessarie su come l'hub IoT di Azure raccoglie di dati dai dispositivi IoT, ad esempio Raspberry Pi, è possibile procedere al provisioning di altri dispositivi IoT per consentire loro di inviare i dati.</span><span class="sxs-lookup"><span data-stu-id="c18b7-101">Now that you have an understanding of how Azure IoT Hub collects data from IoT devices such as the Raspberry Pi you can now move forward to provision other IoT devices to send their data as well.</span></span> <span data-ttu-id="c18b7-102">La configurazione dei dispositivi IoT in un progetto di piccole dimensioni (da 1 a 5 dispositivi) può essere eseguita per un dispositivo alla volta.</span><span class="sxs-lookup"><span data-stu-id="c18b7-102">Completing setup of IoT devices in a small project (1-5 devices) can be done 1 to 1.</span></span> <span data-ttu-id="c18b7-103">Per le distribuzioni di dimensioni più elevate è consigliabile scegliere un metodo di provisioning più efficiente.</span><span class="sxs-lookup"><span data-stu-id="c18b7-103">Larger deployments would require a better method for provisioning.</span></span>

<span data-ttu-id="c18b7-104">Il Servizio Device Provisioning in hub IoT consente ai clienti di configurare il provisioning automatico dei dispositivi nell'hub IoT di Azure e offre la scalabilità del cloud a quello che in precedenza era un processo lungo e da eseguire per un dispositivo alla volta.</span><span class="sxs-lookup"><span data-stu-id="c18b7-104">Azure IoT Hub Device Provisioning Service enables customers to configure zero-touch device provisioning to Azure IoT Hub, and it brings the scalability of the cloud to what was once a lengthy one-at-a-time process.</span></span> <span data-ttu-id="c18b7-105">Il processo è stato progettato in base alle problematiche della catena di approvvigionamento e offre l'infrastruttura necessaria per il provisioning di milioni di dispositivi in modo sicuro e scalabile.</span><span class="sxs-lookup"><span data-stu-id="c18b7-105">The process was designed with the challenges of the supply chain in mind, providing the infrastructure needed to provision millions of devices in a secure and scalable manner.</span></span>

<span data-ttu-id="c18b7-106">Il provisioning di dispositivi automatico con il servizio Device Provisioning ora supporta tutti i protocolli supportati dall'hub IoT, tra cui HTTP, AMQP, MQTT AMQP over WebSocket e MQTT over WebSocket.</span><span class="sxs-lookup"><span data-stu-id="c18b7-106">Automatic device provisioning with the Device Provisioning Service now supports all protocols that IoT Hub supports including HTTP, AMQP, MQTT, AMQP over websockets, and MQTT over websockets.</span></span> <span data-ttu-id="c18b7-107">Questa versione corrisponde inoltre al supporto dei linguaggi dell'SDK esteso sia per il lato dispositivo che per il lato client.</span><span class="sxs-lookup"><span data-stu-id="c18b7-107">This release also corresponds to expanded SDK language support for both the device and client side.</span></span>

## <a name="link-the-device-provisioning-service-to-an-iot-hub"></a><span data-ttu-id="c18b7-108">Collegare il servizio Device Provisioning a un hub IoT</span><span class="sxs-lookup"><span data-stu-id="c18b7-108">Link the Device Provisioning Service to an IoT hub</span></span>

<span data-ttu-id="c18b7-109">Il passaggio successivo consiste nel collegare il servizio Device Provisioning e l'hub IoT in modo che il servizio Device Provisioning in hub IoT possa registrare i dispositivi nell'hub.</span><span class="sxs-lookup"><span data-stu-id="c18b7-109">The next step is to link the Device Provisioning Service and IoT hub so that the IoT Hub Device Provisioning Service can register devices to that hub.</span></span> <span data-ttu-id="c18b7-110">Il servizio può eseguire il provisioning dei dispositivi solo negli hub IoT che sono stati collegati al servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-110">The service can only provision devices to IoT hubs that have been linked to the Device Provisioning Service.</span></span> <span data-ttu-id="c18b7-111">Seguire questa procedura.</span><span class="sxs-lookup"><span data-stu-id="c18b7-111">Follow these steps.</span></span>

1.  <span data-ttu-id="c18b7-112">Nella pagina **Tutte le risorse** nel portale di Azure fare clic sull'istanza del servizio Device Provisioning creata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="c18b7-112">In the **All resources** page on the Azure portal, click the Device Provisioning Service instance you created previously.</span></span>

2.  <span data-ttu-id="c18b7-113">Nella pagina Servizio Device Provisioning fare clic su **Hub IoT collegati**.</span><span class="sxs-lookup"><span data-stu-id="c18b7-113">In the Device Provisioning Service page, click **Linked IoT hubs**.</span></span>

3.  <span data-ttu-id="c18b7-114">Fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="c18b7-114">Click **Add**.</span></span>

4.  <span data-ttu-id="c18b7-115">Nella pagina **Aggiungi collegamento all'hub IoT** fornire le informazioni seguenti e fare clic su **Salva**:</span><span class="sxs-lookup"><span data-stu-id="c18b7-115">In the **Add link to IoT hub** page, provide the following information, and click **Save**:</span></span>

    - <span data-ttu-id="c18b7-116">**Sottoscrizione**: assicurarsi di selezionare la sottoscrizione che contiene l'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c18b7-116">**Subscription:** Make sure the subscription that contains the IoT hub is selected.</span></span> <span data-ttu-id="c18b7-117">È possibile aggiungere un collegamento all'hub IoT presente in un'altra sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="c18b7-117">You can link to IoT hub that resides in a different subscription.</span></span>

    - <span data-ttu-id="c18b7-118">**Hub IoT:**  scegliere il nome dell'hub IoT che si vuole collegare con la nuova istanza del servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-118">**IoT hub:** Choose the name of the IoT hub that you want to link with this Device Provisioning Service instance.</span></span>

    - <span data-ttu-id="c18b7-119">**Criteri di accesso:** selezionare **iothubowner** come credenziali da usare per stabilire il collegamento con l'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c18b7-119">**Access Policy:** Select **iothubowner** as the credentials to use for establishing the link to the IoT hub.</span></span>

![Collegare il nome dell'hub da associare a DPS nel portale](../media/ee6e78754a1d39d86de71fb6872723f3.png)

## <a name="set-the-allocation-policy-on-the-device-provisioning-service"></a><span data-ttu-id="c18b7-121">Impostare criteri di allocazione per il servizio Device Provisioning</span><span class="sxs-lookup"><span data-stu-id="c18b7-121">Set the allocation policy on the Device Provisioning Service</span></span>

<span data-ttu-id="c18b7-122">I criteri di allocazione rappresentano un'impostazione del servizio Device Provisioning in hub IoT che determina la modalità di assegnazione dei dispositivi a un hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c18b7-122">The allocation policy is a IoT Hub Device Provisioning Service setting that determines how devices are assigned to an IoT hub.</span></span> <span data-ttu-id="c18b7-123">Sono supportati tre criteri di allocazione:</span><span class="sxs-lookup"><span data-stu-id="c18b7-123">There are three supported allocation policies:</span></span>

1. <span data-ttu-id="c18b7-124">**Lowest latency** (Latenza minima): il provisioning dei dispositivi viene eseguito in un hub IoT in base all'hub con latenza minima per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c18b7-124">**Lowest latency**: Devices are provisioned to an IoT hub based on the hub with the lowest latency to the device.</span></span>

2. <span data-ttu-id="c18b7-125">**Distribuzione ponderata in modo uniforme**: gli hub IoT collegati hanno le stesse probabilità di ricevere dispositivi sottoposti a provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-125">**Evenly weighted distribution** (default): Linked IoT hubs are equally likely to have devices provisioned to them.</span></span> <span data-ttu-id="c18b7-126">Questa è l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="c18b7-126">This setting is the default.</span></span> <span data-ttu-id="c18b7-127">Se si esegue il provisioning dei dispositivi per un solo hub IoT, è possibile mantenere questa impostazione.</span><span class="sxs-lookup"><span data-stu-id="c18b7-127">If you are provisioning devices to only one IoT hub, you can keep this setting.</span></span>

3. <span data-ttu-id="c18b7-128">**Static configuration via the enrollment list** (Configurazione statica tramite l'elenco di registrazione): la specifica dell'hub IoT desiderato nell'elenco di registrazione ha priorità rispetto ai criteri di allocazione a livello del servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-128">**Static configuration via the enrollment list**: Specification of the desired IoT hub in the enrollment list takes priority over the Device Provisioning Service-level allocation policy.</span></span>

<span data-ttu-id="c18b7-129">Per impostare i criteri di allocazione, nella pagina Device Provisioning Service (Servizio Device Provisioning) fare clic su **Manage allocation policy** (Gestisci criteri di allocazione).</span><span class="sxs-lookup"><span data-stu-id="c18b7-129">To set the allocation policy, in the Device Provisioning Service page click **Manage allocation policy**.</span></span> <span data-ttu-id="c18b7-130">Verificare che i criteri di allocazione siano impostati su **Evenly weighted distribution** (Distribuzione ponderata uniforme) (impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="c18b7-130">Make sure the allocation policy is set to **Evenly weighted distribution** (the default).</span></span> <span data-ttu-id="c18b7-131">Al termine, se si apportano modifiche, fare clic su **Save** (Salva).</span><span class="sxs-lookup"><span data-stu-id="c18b7-131">If you make any changes, click **Save** when you are done.</span></span>

![Gestire i criteri di allocazione](../media/0c5fa5193156f17b4f5d64aab65a414d.png)

## <a name="enroll-the-device"></a><span data-ttu-id="c18b7-133">Registrare il dispositivo</span><span class="sxs-lookup"><span data-stu-id="c18b7-133">Enroll the device</span></span>

<span data-ttu-id="c18b7-134">Questo passaggio prevede l'aggiunta di elementi di sicurezza esclusivi del dispositivo al servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-134">This step involves adding the device's unique security artifacts to the Device Provisioning Service.</span></span> <span data-ttu-id="c18b7-135">Questi elementi di sicurezza si basano sul [meccanismo di attestazione](https://docs.microsoft.com/azure/iot-dps/concepts-device#attestation-mechanism) del dispositivo, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="c18b7-135">These security artifacts are based on the device's [Attestation mechanism](https://docs.microsoft.com/azure/iot-dps/concepts-device#attestation-mechanism) as follows:</span></span>

<span data-ttu-id="c18b7-136">Per i dispositivi basati su TPM sono necessari:</span><span class="sxs-lookup"><span data-stu-id="c18b7-136">For TPM-based devices you need:</span></span>

- <span data-ttu-id="c18b7-137">*Chiave di verifica dell'autenticità*, che è univoca per ogni chip TPM o simulazione e che deve essere richiesta al produttore del chip TPM.</span><span class="sxs-lookup"><span data-stu-id="c18b7-137">The *Endorsement Key* that is unique to each TPM chip or simulation, which is obtained from the TPM chip manufacturer.</span></span> <span data-ttu-id="c18b7-138">Per altre informazioni leggere [Informazioni sulla chiave di verifica dell'autenticità del TPM](https://docs.microsoft.com/windows-server/identity/ad-ds/manage/component-updates/tpm-key-attestation#terminology).</span><span class="sxs-lookup"><span data-stu-id="c18b7-138">Read the [Understand TPM Endorsement Key](https://docs.microsoft.com/windows-server/identity/ad-ds/manage/component-updates/tpm-key-attestation#terminology) for more information.</span></span>

- <span data-ttu-id="c18b7-139">*ID di registrazione*, usato per identificare in modo univoco un dispositivo nell'ambito o nello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="c18b7-139">The *Registration ID* that is used to uniquely identify a device in the namespace/scope.</span></span> <span data-ttu-id="c18b7-140">L'ID può coincidere o meno con l'ID dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c18b7-140">This ID may or may not be the same as the device ID.</span></span> <span data-ttu-id="c18b7-141">L'ID è obbligatorio per ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c18b7-141">The ID is mandatory for every device.</span></span> <span data-ttu-id="c18b7-142">Per i dispositivi basati su TPM, l'ID di registrazione può essere derivato dal TPM stesso, ad esempio un hash SHA-256 della chiave di verifica dell'autenticità del TPM.</span><span class="sxs-lookup"><span data-stu-id="c18b7-142">For TPM-based devices, the registration ID may be derived from the TPM itself, for example, an SHA-256 hash of the TPM Endorsement Key.</span></span>

![Informazioni di registrazione per TPM nel portale](../media/11db90b7128e1cf222a4da45de7cbac8.png)

<span data-ttu-id="c18b7-144">Per i dispositivi basati su X.509 sono necessari:</span><span class="sxs-lookup"><span data-stu-id="c18b7-144">For X.509 based devices you need:</span></span>

- <span data-ttu-id="c18b7-145">[Certificato emesso nel chip X.509](https://docs.microsoft.com/windows/desktop/SecCertEnroll/about-x-509-public-key-certificates) o nella simulazione, sotto forma di file con estensione *pem* o *cer*.</span><span class="sxs-lookup"><span data-stu-id="c18b7-145">The [certificate issued to the X.509](https://docs.microsoft.com/windows/desktop/SecCertEnroll/about-x-509-public-key-certificates) chip or simulation, in the form of either a *.pem* or a *.cer* file.</span></span> <span data-ttu-id="c18b7-146">Per la registrazione singola è necessario usare il *certificato del firmatario* per dispositivo per il sistema X.509, mentre per i gruppi di registrazione è necessario usare il *certificato radice*.</span><span class="sxs-lookup"><span data-stu-id="c18b7-146">For individual enrollment, you need to use the per-device *signer         certificate* for your X.509 system, while for enrollment groups, you need to use the *root certificate*.</span></span>

   ![Aggiungere una registrazione singola per l'attestazione X.509 nel portale](../media/8d56752f453f27e55dd15b7c894ae406.png)

<span data-ttu-id="c18b7-148">È possibile registrare il dispositivo nel servizio Device Provisioning in due modi:</span><span class="sxs-lookup"><span data-stu-id="c18b7-148">There are two ways to enroll the device to the Device Provisioning Service:</span></span>

- <span data-ttu-id="c18b7-149">**Enrollment Groups** (Gruppi di registrazione) Rappresenta un gruppo di dispositivi che condividono un meccanismo di attestazione specifico.</span><span class="sxs-lookup"><span data-stu-id="c18b7-149">**Enrollment Groups** This represents a group of devices that share a specific attestation mechanism.</span></span> <span data-ttu-id="c18b7-150">È consigliabile usare un gruppo di registrazione per un numero elevato di dispositivi che condividono una configurazione iniziale desiderata o per i dispositivi destinati allo stesso tenant.</span><span class="sxs-lookup"><span data-stu-id="c18b7-150">We recommend using an enrollment group for a large number of devices, which share a desired initial configuration, or for devices all going to the same tenant.</span></span> <span data-ttu-id="c18b7-151">Per altre informazioni sull'attestazione dell'identità per i gruppi di registrazione, vedere [Sicurezza](https://docs.microsoft.com/azure/iot-dps/concepts-security#controlling-device-access-to-the-provisioning-service-with-x509-certificates).</span><span class="sxs-lookup"><span data-stu-id="c18b7-151">For more information on Identity attestation for enrollment groups, see [Security](https://docs.microsoft.com/azure/iot-dps/concepts-security#controlling-device-access-to-the-provisioning-service-with-x509-certificates).</span></span>

   ![Aggiungere una registrazione di gruppo per l'attestazione X.509 nel portale](../media/4a9d9ea822887c70f1ff1e4b64b138f1.png)

- <span data-ttu-id="c18b7-153">**Registrazioni singole** Rappresenta una voce per un singolo dispositivo che può eseguire la registrazione per il servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-153">**Individual Enrollments** This represents an entry for a single device that may register with the Device Provisioning Service.</span></span> <span data-ttu-id="c18b7-154">Le registrazioni singole possono usare certificati X.509 o token di firma di accesso condiviso (in un TPM reale o virtuale) come meccanismo di attestazione.</span><span class="sxs-lookup"><span data-stu-id="c18b7-154">Individual enrollments may use either x509 certificates or SAS tokens (in a real or virtual TPM) as attestation mechanisms.</span></span> <span data-ttu-id="c18b7-155">È consigliabile usare le registrazioni singole per i dispositivi che richiedono configurazioni iniziali univoche e per i dispositivi che possono usare solo token di firma di accesso condiviso tramite TPM o TPM virtuale come meccanismo di attestazione.</span><span class="sxs-lookup"><span data-stu-id="c18b7-155">We recommend using individual enrollments for devices that require unique initial configurations, and devices that can only use SAS tokens via TPM or virtual TPM as the attestation mechanism.</span></span> <span data-ttu-id="c18b7-156">In caso di registrazione individuale è possibile specificare l'ID dispositivo dell'hub IoT desiderato.</span><span class="sxs-lookup"><span data-stu-id="c18b7-156">Individual enrollments may have the desired IoT hub device ID specified.</span></span>

<span data-ttu-id="c18b7-157">Ora si registra il dispositivo nell'istanza del servizio Device Provisioning, usando gli elementi di sicurezza necessari in base al meccanismo di attestazione del dispositivo:</span><span class="sxs-lookup"><span data-stu-id="c18b7-157">Now you enroll the device with your Device Provisioning Service instance, using the required security artifacts based on the device's attestation mechanism:</span></span>

1. <span data-ttu-id="c18b7-158">Accedere al portale di Azure, fare clic sul pulsante **Tutte le risorse** nel menu a sinistra e aprire il servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-158">Sign in to the Azure portal, click on the **All resources** button on the left-hand menu and open your Device Provisioning service.</span></span>

2. <span data-ttu-id="c18b7-159">Nel pannello di riepilogo del servizio Device Provisioning selezionare **Gestisci registrazioni**.</span><span class="sxs-lookup"><span data-stu-id="c18b7-159">On the Device Provisioning Service summary blade, select **Manage enrollments**.</span></span> <span data-ttu-id="c18b7-160">Selezionare la scheda **Individual Enrollments** (Registrazioni individuali) o **Enrollment Groups** (Gruppi di registrazione) in base alla configurazione del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c18b7-160">Select either **Individual Enrollments** tab or the **Enrollment Groups** tab as per your device setup.</span></span> <span data-ttu-id="c18b7-161">Fare clic sul pulsante **Aggiungi** in alto.</span><span class="sxs-lookup"><span data-stu-id="c18b7-161">Click the **Add** button at the top.</span></span> <span data-ttu-id="c18b7-162">Selezionare **TPM** o **X.509** come *meccanismo* di attestazione dell'identità e immettere gli elementi di sicurezza appropriati come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="c18b7-162">Select **TPM** or **X.509** as the identity attestation *Mechanism*, and enter the appropriate security artifacts as discussed     previously.</span></span> <span data-ttu-id="c18b7-163">È possibile immettere un nuovo **ID di dispositivo hub IoT**.</span><span class="sxs-lookup"><span data-stu-id="c18b7-163">You may enter a new **IoT Hub device ID**.</span></span> <span data-ttu-id="c18b7-164">Al termine, fare clic sul pulsante **Salva**.</span><span class="sxs-lookup"><span data-stu-id="c18b7-164">Once complete, click the **Save** button.</span></span>

3. <span data-ttu-id="c18b7-165">Quando la registrazione è completata, il dispositivo verrà visualizzato nel portale come riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="c18b7-165">When the device is successfully enrolled, you should see it displayed in the portal as follows:</span></span>

![Successful TPM enrollment in the portal (Registrazione TPM nel portale riuscita)](../media/cb277b2e5bc21cd02669775d536e89c0.png)

<span data-ttu-id="c18b7-167">Dopo la registrazione, il servizio di provisioning attende che il dispositivo venga avviato per potersi connettere successivamente.</span><span class="sxs-lookup"><span data-stu-id="c18b7-167">After enrollment, the provisioning service then waits for the device to boot and connect with it at any later point in time.</span></span> <span data-ttu-id="c18b7-168">Quando il dispositivo viene avviato per la prima volta, la libreria SDK del client interagisce con il chip per estrarre gli elementi di sicurezza dal dispositivo e verifica la registrazione con il servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-168">When your device boots for the first time, the client SDK library interacts with your chip to extract the security artifacts from the device, and verifies registration with your Device Provisioning service.</span></span>

## <a name="start-the-iot-device"></a><span data-ttu-id="c18b7-169">Avviare il dispositivo IoT</span><span class="sxs-lookup"><span data-stu-id="c18b7-169">Start the IoT device</span></span>

<span data-ttu-id="c18b7-170">Il dispositivo IoT può essere un dispositivo reale o un dispositivo simulato.</span><span class="sxs-lookup"><span data-stu-id="c18b7-170">Your IoT device can be a real device, or a simulated device.</span></span> <span data-ttu-id="c18b7-171">Dato che il dispositivo IoT a questo punto è stato registrato in un'istanza del servizio Device Provisioning, il dispositivo può ora essere avviato e chiamare il servizio di provisioning per ottenere il riconoscimento tramite il meccanismo di attestazione.</span><span class="sxs-lookup"><span data-stu-id="c18b7-171">Since the IoT device has now been enrolled with a Device Provisioning Service instance, the device can now boot up, and call the provisioning service to be recognized using the attestation mechanism.</span></span> <span data-ttu-id="c18b7-172">Dopo il riconoscimento nel servizio di provisioning, il dispositivo verrà assegnato a un hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c18b7-172">Once the provisioning service has recognized the device, it will be assigned to an IoT hub.</span></span>

<span data-ttu-id="c18b7-173">Sono inclusi esempi di dispositivo simulato, che usano sia l'attestazione TPM che X.509, per C, Java, C\#, Node.js e Python.</span><span class="sxs-lookup"><span data-stu-id="c18b7-173">Simulated device examples, using both TPM and X.509 attestation, are included for C, Java, C\#, Node.js, and Python.</span></span> <span data-ttu-id="c18b7-174">Ad esempio, un dispositivo simulato che usa TPM e [Azure IoT C SDK](https://github.com/Azure/azure-iot-sdk-c) seguirà il processo descritto nella sezione [Simulare la sequenza del primo avvio per il dispositivo](https://docs.microsoft.com/azure/iot-dps/quick-create-simulated-device#simulate-first-boot-sequence-for-the-device).</span><span class="sxs-lookup"><span data-stu-id="c18b7-174">For example, a simulated device using TPM and the [Azure IoT C SDK](https://github.com/Azure/azure-iot-sdk-c) would follow the process covered in the [Simulate first boot sequence for a device](https://docs.microsoft.com/azure/iot-dps/quick-create-simulated-device#simulate-first-boot-sequence-for-the-device) section.</span></span> <span data-ttu-id="c18b7-175">Lo stesso dispositivo con l'attestazione con certificato X.509 farebbe riferimento a questa sezione per la [sequenza di avvio](https://docs.microsoft.com/azure/iot-dps/quick-create-simulated-device-x509#simulate-first-boot-sequence-for-the-device).</span><span class="sxs-lookup"><span data-stu-id="c18b7-175">The same device using X.509 certificate attestation would refer to this [boot sequence](https://docs.microsoft.com/azure/iot-dps/quick-create-simulated-device-x509#simulate-first-boot-sequence-for-the-device) section.</span></span>

<span data-ttu-id="c18b7-176">Vedere la [guida pratica per MXChip Iot DevKit](https://docs.microsoft.com/azure/iot-dps/how-to-connect-mxchip-iot-devkit) come esempio per un dispositivo reale.</span><span class="sxs-lookup"><span data-stu-id="c18b7-176">Refer to the [How-to guide for the MXChip Iot DevKit](https://docs.microsoft.com/azure/iot-dps/how-to-connect-mxchip-iot-devkit) as an example for a real device.</span></span>

<span data-ttu-id="c18b7-177">Avviare il dispositivo per consentire all'applicazione client del dispositivo di eseguire la registrazione nel servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-177">Start the device to allow your device's client application to start the registration with your Device Provisioning service.</span></span>

## <a name="verify-the-device-is-registered"></a><span data-ttu-id="c18b7-178">Verificare che il dispositivo sia registrato</span><span class="sxs-lookup"><span data-stu-id="c18b7-178">Verify the device is registered</span></span>

<span data-ttu-id="c18b7-179">In seguito all'avvio del dispositivo dovrebbero verificarsi le azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c18b7-179">Once your device boots, the following actions should take place:</span></span>

1. <span data-ttu-id="c18b7-180">Il dispositivo invia una richiesta di registrazione al servizio Device Provisioning.</span><span class="sxs-lookup"><span data-stu-id="c18b7-180">The device sends a registration request to your Device Provisioning service.</span></span>

2. <span data-ttu-id="c18b7-181">Per i dispositivi TPM il servizio Device Provisioning invia di nuovo una richiesta di registrazione a cui risponde il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c18b7-181">For TPM devices, the Device Provisioning Service sends back a registration challenge to which your device responds.</span></span>

3. <span data-ttu-id="c18b7-182">Al termine della registrazione il servizio Device Provisioning invia l'URI dell'hub IoT, l'ID dispositivo e la chiave crittografata di nuovo al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c18b7-182">On successful registration, the Device Provisioning Service sends the IoT hub URI, device ID, and the encrypted key back to the device.</span></span>

4. <span data-ttu-id="c18b7-183">L'applicazione client dell'hub IoT nel dispositivo si connette quindi all'hub.</span><span class="sxs-lookup"><span data-stu-id="c18b7-183">The IoT Hub client application on the device then connects to your hub.</span></span>

5. <span data-ttu-id="c18b7-184">Se la connessione all'hub riesce, il dispositivo dovrebbe essere visualizzato nel riquadro di esplorazione **Dispositivi IoT** dell'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c18b7-184">On successful connection to the hub, you should see the device appear in the IoT hub's **IoT Devices** explorer.</span></span>

![Connessione all'hub nel portale riuscita](../media/12ea6da6eef9bf96be6bd80aa1721173.png)

<!--Reference links

-   <https://docs.microsoft.com/azure/iot-dps/tutorial-set-up-cloud>

-   <https://docs.microsoft.com/azure/iot-dps/tutorial-provision-device-to-hub>-->