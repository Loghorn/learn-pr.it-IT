![Logo di PyTorch](../media/5-image1.png) 

<span data-ttu-id="2c48a-102">Gli ingegneri specializzati in apprendimento profondo non implementano in genere a mano tutte le operazioni algebriche su matrici hardcoded,</span><span class="sxs-lookup"><span data-stu-id="2c48a-102">Typically deep learning engineers don't implement the matrix algebra operations all by hand.</span></span> <span data-ttu-id="2c48a-103">ma si servono di framework come PyTorch o TensorFlow.</span><span class="sxs-lookup"><span data-stu-id="2c48a-103">Instead, they use frameworks such as PyTorch or TensorFlow.</span></span>  

<span data-ttu-id="2c48a-104">PyTorch è un framework basato su Python che offre flessibilità come piattaforma di sviluppo per l'apprendimento profondo.</span><span class="sxs-lookup"><span data-stu-id="2c48a-104">PyTorch is a python-based framework that provides flexibility as a deep learning development platform.</span></span> <span data-ttu-id="2c48a-105">È basato su NumPy, la libreria di calcolo scientifico Python.</span><span class="sxs-lookup"><span data-stu-id="2c48a-105">It's built on the Python scientific computing library, NumPy.</span></span> 

<span data-ttu-id="2c48a-106">A questo punto ci si potrebbe chiedere perché usare PyTorch per creare modelli di apprendimento avanzato?</span><span class="sxs-lookup"><span data-stu-id="2c48a-106">Now you might ask, why would we use PyTorch to build deep learning models?</span></span>  

- <span data-ttu-id="2c48a-107">L'API è intuitiva: l'apprendimento è rapido se l'utente già conosce Python.</span><span class="sxs-lookup"><span data-stu-id="2c48a-107">Easy to use API – If you know Python, you can ramp up quickly.</span></span>
- <span data-ttu-id="2c48a-108">Include il supporto per Python. PyTorch si integra infatti con lo stack di calcolo scientifico.</span><span class="sxs-lookup"><span data-stu-id="2c48a-108">Python support – PyTorch smoothly integrates with the scientific computing stack.</span></span>
- <span data-ttu-id="2c48a-109">Include i grafici di calcolo dinamico. Invece di grafici predefiniti con funzionalità specifiche, PyTorch crea dinamicamente grafici di calcolo che è possibile modificare in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="2c48a-109">Dynamic computation graphs – Instead of predefined graphs with specific functionality, PyTorch builds computational graphs dynamically that can be modified during runtime.</span></span> <span data-ttu-id="2c48a-110">I grafici di calcolo dinamico sono utili per l'invio in batch annidato e quando non si conosce la memoria necessaria per la creazione di una determinata rete.</span><span class="sxs-lookup"><span data-stu-id="2c48a-110">Dynamic computation graphs are valuable for nested batching and when we do not know how much memory will be needed for creating a given network.</span></span>

<span data-ttu-id="2c48a-111">Per altre informazioni su PyTorch, vedere la [documentazione ufficiale su PyTorch.org](https://pytorch.org/about/).</span><span class="sxs-lookup"><span data-stu-id="2c48a-111">For more information about PyTorch, see [PyTorch.org official documentation](https://pytorch.org/about/).</span></span>

## <a name="run-your-first-pytorch-model"></a><span data-ttu-id="2c48a-112">Eseguire il primo modello PyTorch</span><span class="sxs-lookup"><span data-stu-id="2c48a-112">Run your first PyTorch model</span></span>

<span data-ttu-id="2c48a-113">Dopo aver creato un contenitore Docker sottoposto a provisioning da un'immagine PyTorch, è il momento di iniziare a sperimentare.</span><span class="sxs-lookup"><span data-stu-id="2c48a-113">Now that you have a Docker container provisioned from a PyTorch image, it's time to experiment.</span></span> <span data-ttu-id="2c48a-114">Come si ricorderà, è stato scaricato un notebook da [python.org](https://python.org). Questo notebook di esempio illustra la procedura per eseguire il training di una rete finalizzato alla classificazione di immagini in categorie diverse.</span><span class="sxs-lookup"><span data-stu-id="2c48a-114">If you recall, we downloaded a notebook from [python.org](https://python.org). That sample notebook walks you through training a network to classify images  into different categories.</span></span> <span data-ttu-id="2c48a-115">Definisce una rete neurale convoluzionale (CNN) profonda.</span><span class="sxs-lookup"><span data-stu-id="2c48a-115">It defines a deep Convolutional Neural Network (CNN).</span></span>

1. <span data-ttu-id="2c48a-116">Passare nel browser locale al server Jupyter Notebook configurato nell'esercizio precedente.</span><span class="sxs-lookup"><span data-stu-id="2c48a-116">Navigate in your local browser to the Jupyter Notebook server that you set up in the last exercise.</span></span> <span data-ttu-id="2c48a-117">L'URL sarà nel formato:</span><span class="sxs-lookup"><span data-stu-id="2c48a-117">The URL will be of the form:</span></span>

    `<HOSTNAME>.<REGION>.cloudapp.azure.com:8888/?token={sometoken}`

1. <span data-ttu-id="2c48a-118">Selezionare il notebook `first_pytorch_classifier.ipynb` nel dashboard.</span><span class="sxs-lookup"><span data-stu-id="2c48a-118">Select the `first_pytorch_classifier.ipynb` notebook in the dashboard.</span></span>

    ![Selezionare il primo notebook first_pytorch_classifier.ipynb](../media/5-image2.PNG)

    <span data-ttu-id="2c48a-120">Seguire le istruzioni contenute nel notebook per eseguire il training del primo classificatore PyTorch.</span><span class="sxs-lookup"><span data-stu-id="2c48a-120">Follow the instructions in the notebook to train your first PyTorch classifier.</span></span>

    ![screenshot del notebook di training di un classificatore](../media/5-image3.PNG)

2. <span data-ttu-id="2c48a-122">Iniziare dalla parte superiore del notebook ed eseguire ogni cella in ordine.</span><span class="sxs-lookup"><span data-stu-id="2c48a-122">Start from the top of the notebook and run each cell in order.</span></span> <span data-ttu-id="2c48a-123">Tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="2c48a-123">Note the following:</span></span>

    - <span data-ttu-id="2c48a-124">L'esecuzione di alcune celle richiede molto tempo.</span><span class="sxs-lookup"><span data-stu-id="2c48a-124">Some of the cells take a long time to run.</span></span> <span data-ttu-id="2c48a-125">Osservare il puntino in alto a destra del notebook accanto alle parole "Python 3".</span><span class="sxs-lookup"><span data-stu-id="2c48a-125">Observe the small dot in the top right of the notebook beside the words "Python 3".</span></span> <span data-ttu-id="2c48a-126">Quando il kernel è occupato con un'operazione, il punto diventa un cerchio pieno più scuro.</span><span class="sxs-lookup"><span data-stu-id="2c48a-126">When the kernel is busy with an operation, the dot becomes a filled, darker, circle.</span></span> <span data-ttu-id="2c48a-127">Rimarrà visualizzato in questo modo fino al termine dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="2c48a-127">It remains that way until the operation is complete.</span></span> 
    - <span data-ttu-id="2c48a-128">Si esegue il training di una rete CNN per classificare le immagini.</span><span class="sxs-lookup"><span data-stu-id="2c48a-128">You're training a CNN to classify images.</span></span> <span data-ttu-id="2c48a-129">Una volta completato il training, il notebook testerà le immagini etichettate a fronte del modello.</span><span class="sxs-lookup"><span data-stu-id="2c48a-129">Once the network is trained, the notebook will test labeled images against the model.</span></span> <span data-ttu-id="2c48a-130">Registra la stima eseguita per ogni immagine e calcola l'accuratezza del modello.</span><span class="sxs-lookup"><span data-stu-id="2c48a-130">It records the prediction made for each image and calculates the accuracy of the model.</span></span> <span data-ttu-id="2c48a-131">I risultati verranno visualizzati nel formato seguente.</span><span class="sxs-lookup"><span data-stu-id="2c48a-131">You'll see results in the following format.</span></span>

    ![Risultati del training che indicano l'accuratezza del modello](../media/accuracy.png)
    
    - <span data-ttu-id="2c48a-133">È possibile acquisire familiarità con il notebook nella [documentazione delle esercitazioni di PyTorch](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html) online.</span><span class="sxs-lookup"><span data-stu-id="2c48a-133">You can learn more about the notebook in the [PyTorch Tutorials documentation](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html) online.</span></span>
    
    - <span data-ttu-id="2c48a-134">Verso la fine del notebook, le note indicano un training su una GPU.</span><span class="sxs-lookup"><span data-stu-id="2c48a-134">Towards the end of the notebook, the notes talk about training on a GPU.</span></span> <span data-ttu-id="2c48a-135">Se si sono eseguiti gli esercizi in questo modulo, è stata configurata una VM basata su CPU.</span><span class="sxs-lookup"><span data-stu-id="2c48a-135">If you followed the exercises in this module, you have set up a CPU-based VM.</span></span> <span data-ttu-id="2c48a-136">Questa situazione è ideale per un modello di queste dimensioni e potrebbero non essere riscontrati miglioramenti significativi nel tempo di training con una GPU.</span><span class="sxs-lookup"><span data-stu-id="2c48a-136">This is fine for a model this size and you may not see any significant improvements in training time with a GPU.</span></span> <span data-ttu-id="2c48a-137">Per provare il modulo usando una macchina virtuale con GPU, è necessario apportare due modifiche:</span><span class="sxs-lookup"><span data-stu-id="2c48a-137">If you do want to try the module using a  virtual machine with GPUs, then there are two changes you need to make:</span></span>
    - <span data-ttu-id="2c48a-138">Effettuare il provisioning di DSVM in una dimensione di VM serie N abilitata per la GPU.</span><span class="sxs-lookup"><span data-stu-id="2c48a-138">Provision DSVM on a GPU enabled, N-series VM size.</span></span>
    - <span data-ttu-id="2c48a-139">Creare un contenitore usando `nvidia-docker` invece di `docker` nell'esercizio precedente.</span><span class="sxs-lookup"><span data-stu-id="2c48a-139">Create a container using `nvidia-docker` instead of `docker` in the previous exercise.</span></span>