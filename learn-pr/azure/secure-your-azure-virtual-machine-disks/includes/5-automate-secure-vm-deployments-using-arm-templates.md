<span data-ttu-id="295b2-101">Si supponga che l'azienda voglia distribuire numerosi server come parte della transizione al cloud.</span><span class="sxs-lookup"><span data-stu-id="295b2-101">Suppose your company is deploying several servers as part of their cloud transition.</span></span> <span data-ttu-id="295b2-102">I dischi delle macchine virtuali devono essere crittografati durante la distribuzione, per evitare periodi di vulnerabilità dei dischi stessi.</span><span class="sxs-lookup"><span data-stu-id="295b2-102">VM disks must be encrypted during the deployment, so there's no time when the disks are vulnerable.</span></span> <span data-ttu-id="295b2-103">Si vuole automatizzare questo processo ed è necessario modificare i modelli di Azure Resource Manager (ARM) per abilitare automaticamente la crittografia.</span><span class="sxs-lookup"><span data-stu-id="295b2-103">You want to automate this process, and have to modify the Azure Resource Manager templates to automatically enable encryption.</span></span>

<span data-ttu-id="295b2-104">In questo caso si illustrerà come usare un modello di Azure Resource Manager per abilitare automaticamente la crittografia per le nuove macchine virtuali Windows.</span><span class="sxs-lookup"><span data-stu-id="295b2-104">Here, we'll look at how to use an Azure Resource Manager template to automatically enable encryption for new Windows VMs.</span></span>

## <a name="what-are-azure-resource-manager-templates"></a><span data-ttu-id="295b2-105">Cosa sono i modelli di Azure Resource Manager?</span><span class="sxs-lookup"><span data-stu-id="295b2-105">What are Azure Resource Manager templates?</span></span>

<span data-ttu-id="295b2-106">Questi modelli sono file JSON usati per definire una risorsa da distribuire in Azure, ad esempio una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="295b2-106">These templates are JSON files used to define a resource to deploy to Azure, such as a virtual machine.</span></span> <span data-ttu-id="295b2-107">È possibile scriverli da zero e per alcune risorse di Azure, incluse le macchine virtuali, è possibile generarli tramite il portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="295b2-107">You can write them from scratch, and for some Azure resources, including VMs, you can use the Azure portal to generate them.</span></span> <span data-ttu-id="295b2-108">Sarà necessario immettere le informazioni necessarie per una distribuzione di macchina virtuale manuale, ma anziché distribuire la macchina virtuale in Azure, si salverà il modello.</span><span class="sxs-lookup"><span data-stu-id="295b2-108">You'll need to complete the required information for a manual VM deployment, but instead of deploying the VM to Azure, you save the template.</span></span>

<span data-ttu-id="295b2-109">In GitHub sono disponibili modelli di esempio.</span><span class="sxs-lookup"><span data-stu-id="295b2-109">There are example templates available in GitHub.</span></span>

## <a name="using-github-templates"></a><span data-ttu-id="295b2-110">Uso dei modelli di GitHub</span><span class="sxs-lookup"><span data-stu-id="295b2-110">Using GitHub templates</span></span>

<span data-ttu-id="295b2-111">In GitHub è disponibile un modello denominato **Enable encryption on a running Windows VM ARM** (Abilitare la crittografia in una macchina virtuale Windows tramite Azure Resource Manager).</span><span class="sxs-lookup"><span data-stu-id="295b2-111">GitHub has a template for enabling encryption called the **Enable encryption on a running Windows VM ARM**.</span></span> <span data-ttu-id="295b2-112">Il modello è disponibile nel repository [Modelli di avvio rapido di Azure](https://github.com/Azure/azure-quickstart-templates).</span><span class="sxs-lookup"><span data-stu-id="295b2-112">You can find it in the [Azure Quickstart Templates](https://github.com/Azure/azure-quickstart-templates) repository.</span></span> <span data-ttu-id="295b2-113">La pagina Leggimi del modello include un pulsante **Distribuisci in Azure** che apre il modello nel portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="295b2-113">The readme page for the template provides a **Deploy to Azure** button that then opens the template in the Azure portal.</span></span>

<span data-ttu-id="295b2-114">Il modello consente di distribuire una macchina virtuale Windows Server con la crittografia già abilitata.</span><span class="sxs-lookup"><span data-stu-id="295b2-114">The template enables you to deploy a Windows Server VM, with encryption pre-enabled.</span></span> <span data-ttu-id="295b2-115">Prima di usare il modello, assicurarsi che siano soddisfatti tutti i prerequisiti di crittografia.</span><span class="sxs-lookup"><span data-stu-id="295b2-115">Before using the template, you must make sure that all of the encryption prerequisites are in place.</span></span> <span data-ttu-id="295b2-116">Saranno anche necessarie le informazioni di configurazione incluse nello script dei prerequisiti, ad esempio l'ID client Azure Active Directory e il segreto client Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="295b2-116">You'll also need the configuration information that is provided by the prerequisites script, such as Azure Active Directory Client ID and Azure Active Directory Client Secret.</span></span>

<span data-ttu-id="295b2-117">Per creare una nuova macchina virtuale, immettere le informazioni necessarie nel modello.</span><span class="sxs-lookup"><span data-stu-id="295b2-117">You create a new VM by entering the required information on the template.</span></span> <span data-ttu-id="295b2-118">Avviare quindi la distribuzione facendo clic su **Acquista** (i costi sono in genere i normali addebiti di calcolo di Azure).</span><span class="sxs-lookup"><span data-stu-id="295b2-118">You then initiate deployment by clicking **Purchase** (the cost is typically the normal Azure compute charge).</span></span>

## <a name="deploy-an-encrypted-vm-by-using-a-template"></a><span data-ttu-id="295b2-119">Distribuire una macchina virtuale crittografata tramite un modello</span><span class="sxs-lookup"><span data-stu-id="295b2-119">Deploy an encrypted VM by using a template</span></span>

<span data-ttu-id="295b2-120">I passaggi principali per la distribuzione di una macchina virtuale crittografata tramite un modello sono:</span><span class="sxs-lookup"><span data-stu-id="295b2-120">The main steps involved in deploying an encrypted VM using a template are:</span></span>

1. <span data-ttu-id="295b2-121">Accedere ed eseguire il modello **Enable encryption on a running Windows VM ARM** (Abilitare la crittografia in una macchina virtuale che esegue Windows tramite Azure Resource Manager) in GitHub.</span><span class="sxs-lookup"><span data-stu-id="295b2-121">Access and run the **Enable encryption on a running Windows VM ARM** template from GitHub.</span></span>

1. <span data-ttu-id="295b2-122">Aggiungere i dettagli necessari nella pagina di configurazione dello script.</span><span class="sxs-lookup"><span data-stu-id="295b2-122">Add the required details in the script configuration page.</span></span>

1. <span data-ttu-id="295b2-123">Distribuire una nuova macchina virtuale tramite lo script facendo clic su **Acquista**.</span><span class="sxs-lookup"><span data-stu-id="295b2-123">Deploy a new VM using the script by clicking **Purchase**.</span></span>

1. <span data-ttu-id="295b2-124">Usare il portale di Azure per verificare lo stato di crittografia del disco.</span><span class="sxs-lookup"><span data-stu-id="295b2-124">Use the Azure portal to verify disk encryption status.</span></span>
