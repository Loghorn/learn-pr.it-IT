<span data-ttu-id="81e69-101">Dopo aver creato l'account di archiviazione, sarà necessario esaminare come lavorare con la coda che conterrà.</span><span class="sxs-lookup"><span data-stu-id="81e69-101">Now that we have a storage account, let's look at how we work with the queue that it will hold.</span></span>

<span data-ttu-id="81e69-102">Per accedere a una coda, sono necessarie tre informazioni:</span><span class="sxs-lookup"><span data-stu-id="81e69-102">To access a queue, you need three pieces of information:</span></span>
 1. <span data-ttu-id="81e69-103">nome dell'account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="81e69-103">storage account name</span></span>
 2. <span data-ttu-id="81e69-104">nome della coda</span><span class="sxs-lookup"><span data-stu-id="81e69-104">queue name</span></span>
 3. <span data-ttu-id="81e69-105">token di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-105">authorization token.</span></span>

<span data-ttu-id="81e69-106">Queste informazioni vengono usate da entrambe le applicazioni che comunicano con la coda (il Web front-end che aggiunge i messaggi e il livello intermedio che li elabora).</span><span class="sxs-lookup"><span data-stu-id="81e69-106">This information is used by both applications that talk to the queue (the web front end that adds messages and the mid-tier that processes them).</span></span>

## <a name="queue-identity"></a><span data-ttu-id="81e69-107">Identità della coda</span><span class="sxs-lookup"><span data-stu-id="81e69-107">Queue identity</span></span>

<span data-ttu-id="81e69-108">A ogni coda è stato assegnato un nome durante la creazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-108">Every queue has a name that you assign during creation.</span></span> <span data-ttu-id="81e69-109">Il nome deve essere univoco all'interno dell'account di archiviazione ma non deve necessariamente essere globalmente univoco (a differenza del nome dell'account di archiviazione).</span><span class="sxs-lookup"><span data-stu-id="81e69-109">The name must be unique within your storage account but doesn't need to be globally unique (unlike the storage account name).</span></span>

<span data-ttu-id="81e69-110">La combinazione di nome dell'account di archiviazione e nome della coda identifica in modo univoco una coda.</span><span class="sxs-lookup"><span data-stu-id="81e69-110">The combination of your storage account name and your queue name uniquely identifies a queue.</span></span>

## <a name="access-authorization"></a><span data-ttu-id="81e69-111">Autorizzazione all'accesso</span><span class="sxs-lookup"><span data-stu-id="81e69-111">Access authorization</span></span>

<span data-ttu-id="81e69-112">Tutte le richieste a una coda devono essere autorizzate e sono disponibili diverse opzioni tra cui scegliere.</span><span class="sxs-lookup"><span data-stu-id="81e69-112">Every request to a queue must be authorized and there are several options to choose from.</span></span>

| <span data-ttu-id="81e69-113">Tipo di autorizzazione</span><span class="sxs-lookup"><span data-stu-id="81e69-113">Authorization Type</span></span> | <span data-ttu-id="81e69-114">Descrizione</span><span class="sxs-lookup"><span data-stu-id="81e69-114">Description</span></span> |
|--------------------|-------------|
| <span data-ttu-id="81e69-115">**Azure Active Directory**</span><span class="sxs-lookup"><span data-stu-id="81e69-115">**Azure Active Directory**</span></span> | <span data-ttu-id="81e69-116">è possibile usare l'autenticazione basata sui ruoli e identificare i client specifici in base alle credenziali AAD.</span><span class="sxs-lookup"><span data-stu-id="81e69-116">you can use role-based authentication and identify specific clients based on AAD credentials.</span></span> |
| <span data-ttu-id="81e69-117">**Chiave condivisa**</span><span class="sxs-lookup"><span data-stu-id="81e69-117">**Shared Key**</span></span> | <span data-ttu-id="81e69-118">Talvolta chiamata **chiave dell'account**, si tratta di una firma di chiave crittografata associata all'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-118">Sometimes referred to as an **account key**, this is an encrypted key signature associated with the storage account.</span></span> <span data-ttu-id="81e69-119">Ogni account di archiviazione dispone di due di queste chiavi che possono essere passate con ogni richiesta per autenticare l'accesso.</span><span class="sxs-lookup"><span data-stu-id="81e69-119">Every storage account has two of these keys that can be passed with each request to authenticate access.</span></span> <span data-ttu-id="81e69-120">Questo approccio è simile all'uso di una password radice: fornisce _l'accesso completo_ all'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-120">Using this approach is like using a root password - it provides _full access_ to the storage account.</span></span> |
| <span data-ttu-id="81e69-121">**Firma di accesso condiviso**</span><span class="sxs-lookup"><span data-stu-id="81e69-121">**Shared access signature**</span></span> | <span data-ttu-id="81e69-122">Una firma di accesso condiviso (SAS) è un URI generato che concede ai client l'accesso limitato agli oggetti nell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-122">A shared access signature (SAS) is a generated URI that grants limited access to objects in your storage account to clients.</span></span> <span data-ttu-id="81e69-123">È possibile limitare l'accesso a risorse e autorizzazioni specifiche ed esaminare un intervallo di dati per disattivare automaticamente l'accesso dopo un periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="81e69-123">You can restrict access to specific resources, permissions, and scope to a data range to automatically turn off access after a period of time.</span></span>  |

> [!NOTE]
> <span data-ttu-id="81e69-124">L'autorizzazione tramite chiave dell'account viene usata perché è il modo più semplice per iniziare a lavorare con le code, tuttavia si consiglia di usare la firma di accesso condiviso (SAS) o Azure Active Directory (AAD) nelle app di produzione.</span><span class="sxs-lookup"><span data-stu-id="81e69-124">We will use the account key authorization because it is the simplest way to get started working with queues, however it's recommended that you either use shared access signature (SAS) or Azure Active Directory (AAD) in production apps.</span></span>

### <a name="retrieving-the-account-key"></a><span data-ttu-id="81e69-125">Recupero della chiave dell'account</span><span class="sxs-lookup"><span data-stu-id="81e69-125">Retrieving the account key</span></span>
 
<span data-ttu-id="81e69-126">La chiave dell'account è disponibile nella sezione **Impostazioni > Chiavi di accesso** dell'account di archiviazione nel portale di Azure, oppure è possibile recuperarla tramite la riga di comando:</span><span class="sxs-lookup"><span data-stu-id="81e69-126">Your account key is available in the **Settings > Access keys** section of your storage account in the Azure portal, or you can retrieve it through the command line:</span></span>

```azurecli
az storage account keys list ...
```

```powershell
Get-AzureRmStorageAccountKey ...
```

## <a name="accessing-queues"></a><span data-ttu-id="81e69-127">Accesso alle code</span><span class="sxs-lookup"><span data-stu-id="81e69-127">Accessing queues</span></span>

<span data-ttu-id="81e69-128">È possibile accedere a una coda usando un'API REST.</span><span class="sxs-lookup"><span data-stu-id="81e69-128">You access a queue using a REST API.</span></span> <span data-ttu-id="81e69-129">A tale scopo, si userà un URL che combina il nome assegnato all'account di archiviazione con il dominio `queue.core.windows.net` e il percorso della coda con cui si desidera lavorare.</span><span class="sxs-lookup"><span data-stu-id="81e69-129">To do this, you'll use a URL that combines the name you gave the storage account with the domain `queue.core.windows.net` and the path to the queue you want to work with.</span></span> <span data-ttu-id="81e69-130">Ad esempio: `http://<storage account>.queue.core.windows.net/<queue name>`.</span><span class="sxs-lookup"><span data-stu-id="81e69-130">For example: `http://<storage account>.queue.core.windows.net/<queue name>`.</span></span> <span data-ttu-id="81e69-131">È necessario includere un'intestazione `Authorization` con ogni richiesta.</span><span class="sxs-lookup"><span data-stu-id="81e69-131">An `Authorization` header must be included with every request.</span></span> <span data-ttu-id="81e69-132">Il valore può essere uno dei tre stili di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-132">The value can be any of the three authorization styles.</span></span>

### <a name="using-the-azure-storage-client-library-for-net"></a><span data-ttu-id="81e69-133">Uso della libreria client Archiviazione di Azure per .NET</span><span class="sxs-lookup"><span data-stu-id="81e69-133">Using the Azure Storage Client Library for .NET</span></span>

<span data-ttu-id="81e69-134">La libreria client Archiviazione di Azure per .NET è una libreria fornita da Microsoft che formula le richieste REST e analizza le risposte REST per l'utente.</span><span class="sxs-lookup"><span data-stu-id="81e69-134">The Azure Storage Client Library for .NET is a library provided by Microsoft that formulates REST requests and parses REST responses for you.</span></span> <span data-ttu-id="81e69-135">Questo riduce notevolmente la quantità di codice che è necessario scrivere.</span><span class="sxs-lookup"><span data-stu-id="81e69-135">This greatly reduces the amount of code you need to write.</span></span> <span data-ttu-id="81e69-136">L'accesso tramite la libreria client richiede le stesse informazioni (nome account di archiviazione, nome della coda e chiave dell'account); tuttavia, sono organizzate in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="81e69-136">Access using the client library still requires the same pieces of information (storage account name, queue name, and account key); however, they are organized differently.</span></span>

<span data-ttu-id="81e69-137">La libreria client usa una **stringa di connessione** per stabilire la connessione.</span><span class="sxs-lookup"><span data-stu-id="81e69-137">The client library uses a **connection string** to establish your connection.</span></span> <span data-ttu-id="81e69-138">La stringa di connessione è disponibile nella sezione **Impostazioni** dell'account di archiviazione nel portale di Azure, oppure tramite l'interfaccia della riga di comando di Azure e PowerShell.</span><span class="sxs-lookup"><span data-stu-id="81e69-138">Your connection string is available in the **Settings** section of your Storage Account in the Azure portal, or through the Azure CLI and PowerShell.</span></span>

<span data-ttu-id="81e69-139">Una stringa di connessione è una stringa che combina il nome dell'account di archiviazione e la chiave dell'account e deve essere nota all'applicazione per accedere all'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="81e69-139">A connection string is a string that combines a storage account name and account key and must be known to the application to access the storage account.</span></span> <span data-ttu-id="81e69-140">Il formato è simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="81e69-140">The format looks like this:</span></span>

```csharp
string connectionString = "DefaultEndpointsProtocol=https;AccountName=<your storage account name>;AccountKey=<your key>;EndpointSuffix=core.windows.net"
```

> [!WARNING]
> <span data-ttu-id="81e69-141">Questo valore della stringa deve essere archiviato in una posizione sicura, poiché chiunque abbia accesso a questa stringa di connessione sarà in grado di modificare la coda.</span><span class="sxs-lookup"><span data-stu-id="81e69-141">This string value should be stored in a secure location since anyone who has access to this connection string would be able to manipulate the queue.</span></span>

<span data-ttu-id="81e69-142">Si noti che la stringa di connessione non include il nome della coda.</span><span class="sxs-lookup"><span data-stu-id="81e69-142">Notice that the connection string doesn't include the queue name.</span></span> <span data-ttu-id="81e69-143">Il nome della coda viene fornito nel codice quando si stabilisce una connessione alla coda.</span><span class="sxs-lookup"><span data-stu-id="81e69-143">The queue name is supplied in your code when you establish a connection to the queue.</span></span>

<span data-ttu-id="81e69-144">È necessario ottenere la stringa di connessione da Azure e configurare una nuova applicazione per usarla.</span><span class="sxs-lookup"><span data-stu-id="81e69-144">Let's get our connection string from Azure and set up a new application to use it.</span></span>
