<span data-ttu-id="d29b5-101">Dopo aver compreso come verranno archiviati i dati tra gli account di archiviazione, contenitori e blob, possiamo pensare alle risorse di Azure da creare per supportare l'app.</span><span class="sxs-lookup"><span data-stu-id="d29b5-101">Once we have an idea of how we're going to store data across storage accounts, containers and blobs, we can think about the Azure resources we need to create to support the app.</span></span>

### <a name="storage-accounts"></a><span data-ttu-id="d29b5-102">Account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="d29b5-102">Storage accounts</span></span>

<span data-ttu-id="d29b5-103">La creazione di account di archiviazione è un'attività di amministrazione e gestione che avviene prima di distribuire ed eseguire l'app.</span><span class="sxs-lookup"><span data-stu-id="d29b5-103">Storage account creation is an administrative/management activity that takes place prior to deploying and running your app.</span></span> <span data-ttu-id="d29b5-104">Gli account sono in genere creati da uno script di configurazione o distribuzione dell'ambiente, un modello di Azure Resource Manager, o manualmente dall'amministratore.</span><span class="sxs-lookup"><span data-stu-id="d29b5-104">Accounts are usually created by a deployment or environment setup script, an Azure Resource Manager template, or manually by an administrator.</span></span> <span data-ttu-id="d29b5-105">Le applicazioni diverse dagli strumenti di amministrazione generalmente non dispongono delle autorizzazioni per creare gli account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d29b5-105">Applications other than administrative tools generally should not have permissions to create storage accounts.</span></span>

### <a name="containers"></a><span data-ttu-id="d29b5-106">Contenitori</span><span class="sxs-lookup"><span data-stu-id="d29b5-106">Containers</span></span>

<span data-ttu-id="d29b5-107">A differenza della creazione di account di archiviazione, la creazione del contenitore è un'attività semplice che è opportuno eseguire all'interno di un'app.</span><span class="sxs-lookup"><span data-stu-id="d29b5-107">Unlike storage account creation, container creation is a lightweight activity that makes sense to perform from within an app.</span></span> <span data-ttu-id="d29b5-108">Non è insolito che le app creino ed eliminino i contenitori, in quanto parte del proprio lavoro.</span><span class="sxs-lookup"><span data-stu-id="d29b5-108">It's not uncommon for apps to create and delete containers as part of their work.</span></span>

<span data-ttu-id="d29b5-109">Per le app che si basano su un set noto di contenitori con nomi hard-coded o preconfigurati, la procedura tipica consiste nel consentire all'app di creare i contenitori di cui necessita all'avvio o al primo utilizzo se non sono già presenti.</span><span class="sxs-lookup"><span data-stu-id="d29b5-109">For apps that rely on a known set of containers with hard-coded or preconfigured names, typical practice is to let the app create the containers it needs on startup or first usage if they don't already exist.</span></span> <span data-ttu-id="d29b5-110">Consentire all'app di creare contenitori anziché crearli come parte della distribuzione dell'app elimina la necessità per l'applicazione e per il processo di distribuzione di conoscere i nomi dei contenitori usati dall'app.</span><span class="sxs-lookup"><span data-stu-id="d29b5-110">Letting your app create containers instead of doing it as part of your app's deployment eliminates the need for both your application and your deployment process to know the names of the containers the app uses.</span></span>

## <a name="exercise"></a><span data-ttu-id="d29b5-111">Esercizio</span><span class="sxs-lookup"><span data-stu-id="d29b5-111">Exercise</span></span>

<span data-ttu-id="d29b5-112">Eseguire un'app ASP.NET Core incompleta aggiungendo il codice per usare l'archiviazione BLOB di Azure.</span><span class="sxs-lookup"><span data-stu-id="d29b5-112">We're going to complete an unfinished ASP.NET Core app by adding code to use Azure Blob storage.</span></span> <span data-ttu-id="d29b5-113">Questo esercizio riguarda più l'esplorazione dell'API dell'archiviazione BLOB che la progettazione di un'organizzazione e dello schema di denominazione, ma di seguito viene presentata una breve panoramica dell'applicazione e delle modalità di archiviazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="d29b5-113">This exercise is more about exploring the Blob storage API than it is about designing an organization and naming scheme, but here's a quick overview of the app and how it stores data.</span></span>

![Screenshot dell'app Web FileUploader](../media-drafts/fileuploader-with-files.PNG)

<span data-ttu-id="d29b5-115">L'app funziona come una cartella condivisa che accetta i caricamenti di file e li rende disponibili per il download.</span><span class="sxs-lookup"><span data-stu-id="d29b5-115">Our app works like a shared folder that accepts file uploads and makes them available for download.</span></span> <span data-ttu-id="d29b5-116">Non usa un database per organizzare i blob &mdash; ma corregge i nomi dei file caricati e li usa come nomi di blob direttamente.</span><span class="sxs-lookup"><span data-stu-id="d29b5-116">It doesn't use a database for organizing blobs &mdash; instead, it sanitizes the names of uploaded files and uses them as blob names directly.</span></span> <span data-ttu-id="d29b5-117">Tutti i file caricati vengono archiviati in un singolo contenitore.</span><span class="sxs-lookup"><span data-stu-id="d29b5-117">All uploaded files are stored in a single container.</span></span>

<span data-ttu-id="d29b5-118">Il codice con cui si inizierà viene compilato ed eseguito, ma le parti responsabili per l'archiviazione e il caricamento dei dati sono vuote.</span><span class="sxs-lookup"><span data-stu-id="d29b5-118">The code we'll start with compiles and runs, but the parts responsible for storing and loading data are empty.</span></span> <span data-ttu-id="d29b5-119">Dopo aver completato il codice, l'app verrà distribuita nel servizio app di Azure e testata.</span><span class="sxs-lookup"><span data-stu-id="d29b5-119">After we complete the code, we'll deploy the app to Azure App Service and test it.</span></span>

<span data-ttu-id="d29b5-120">Configurare l'infrastruttura di archiviazione per l'app.</span><span class="sxs-lookup"><span data-stu-id="d29b5-120">Let's set up the storage infrastructure for our app.</span></span>

### <a name="resource-group-and-storage-account"></a><span data-ttu-id="d29b5-121">Gruppo di risorse e account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="d29b5-121">Resource group and storage account</span></span>

<span data-ttu-id="d29b5-122">In primo luogo, verrà creato un gruppo di risorse per contenere tutte le risorse di questo esercizio.</span><span class="sxs-lookup"><span data-stu-id="d29b5-122">First, we'll create a resource group to contain all of the resources in this exercise.</span></span> <span data-ttu-id="d29b5-123">Verranno eliminate alla fine per eseguire la pulizia di tutto ciò che è stato creato.</span><span class="sxs-lookup"><span data-stu-id="d29b5-123">We'll delete it at the end to clean up everything we create.</span></span> <span data-ttu-id="d29b5-124">Verrà inoltre creato l'account di archiviazione, che l'app userà per archiviare i blob.</span><span class="sxs-lookup"><span data-stu-id="d29b5-124">We'll also create the storage account our app will use to store blobs.</span></span>

<span data-ttu-id="d29b5-125">Usare il terminale Azure Cloud Shell per creare il gruppo di risorse e account di archiviazione eseguendo i seguenti comandi dell'interfaccia della riga di comando di Azure.</span><span class="sxs-lookup"><span data-stu-id="d29b5-125">Use the Azure Cloud Shell terminal to create the resource group and storage account by running the following Azure CLI commands.</span></span> <span data-ttu-id="d29b5-126">È necessario specificare un nome univoco per l'account di archiviazione &mdash; prendere nota per un uso successivo.</span><span class="sxs-lookup"><span data-stu-id="d29b5-126">You'll need to provide a unique name for the storage account &mdash; make a note of it for later.</span></span> <span data-ttu-id="d29b5-127">La scelta di `eastus` per il percorso è arbitraria.</span><span class="sxs-lookup"><span data-stu-id="d29b5-127">The choice of `eastus` for the location is arbitrary.</span></span>

```console
az group create --name blob-exercise-group --location eastus
az storage account create --name <your-unique-storage-account-name> --resource-group blob-exercise-group --location eastus --kind StorageV2
```

> [!NOTE]
> <span data-ttu-id="d29b5-128">Perché `--kind StorageV2`?</span><span class="sxs-lookup"><span data-stu-id="d29b5-128">Why `--kind StorageV2`?</span></span> <span data-ttu-id="d29b5-129">Esistono diversi tipi di account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d29b5-129">There are a few different kinds of storage accounts.</span></span> <span data-ttu-id="d29b5-130">Per la maggior parte degli scenari, è consigliabile usare un account di archiviazione generico v2.</span><span class="sxs-lookup"><span data-stu-id="d29b5-130">For most scenarios, you should use general-purpose v2 accounts.</span></span> <span data-ttu-id="d29b5-131">L'unico motivo per cui è necessario specificare esplicitamente `--kind StorageV2` è che gli account di archiviazione generici v2 sono ancora relativamente nuovi e non sono ancora l'impostazione predefinita nel portale di Azure o nell'interfaccia della riga di comando di Azure.</span><span class="sxs-lookup"><span data-stu-id="d29b5-131">The only reason you need to explicitly specify `--kind StorageV2` is that general-purpose v2 accounts are still fairly new and have not yet been made the default in the Azure Portal or the Azure CLI.</span></span>

### <a name="container"></a><span data-ttu-id="d29b5-132">Contenitore</span><span class="sxs-lookup"><span data-stu-id="d29b5-132">Container</span></span>

<span data-ttu-id="d29b5-133">L'applicazione con cui lavoreremo in questo modulo usa un singolo contenitore.</span><span class="sxs-lookup"><span data-stu-id="d29b5-133">The app we'll be working with in this module uses a single container.</span></span> <span data-ttu-id="d29b5-134">È necessario seguire le procedure consigliate per lasciare che l'app crei il contenitore all'avvio.</span><span class="sxs-lookup"><span data-stu-id="d29b5-134">We're going to follow the best practice of letting the app create the container at startup.</span></span> <span data-ttu-id="d29b5-135">Tuttavia, la creazione del contenitore può essere eseguita dal comando di Azure: eseguire `az storage container create -h` nel terminale Cloud Shell se si desidera vedere la documentazione.</span><span class="sxs-lookup"><span data-stu-id="d29b5-135">However, container creation can be done from the Azure CLI: run `az storage container create -h` in the Cloud Shell terminal if you'd like to see the documentation.</span></span>