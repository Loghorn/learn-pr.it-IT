<span data-ttu-id="501fd-101">Per il funzionamento corretto del servizio di bilanciamento del carico, è prima necessario configurare le impostazioni che ne controllano il comportamento.</span><span class="sxs-lookup"><span data-stu-id="501fd-101">Before the load balancer will function correctly, you must configure settings that control the load balancer's behavior.</span></span> <span data-ttu-id="501fd-102">Di seguito verrà illustrata la configurazione della rete, del probe di integrità, delle regole di sicurezza, delle regole di bilanciamento del carico e del pool di server.</span><span class="sxs-lookup"><span data-stu-id="501fd-102">Here, you will look at configuring the network, health probe, security rules, load-balancing rules, and server pool.</span></span>

## <a name="steps-for-configuring-a-basic-public-load-balancer"></a><span data-ttu-id="501fd-103">Passaggi per la configurazione di un servizio di bilanciamento del carico pubblico Basic</span><span class="sxs-lookup"><span data-stu-id="501fd-103">Steps for configuring a basic public load balancer</span></span>

<span data-ttu-id="501fd-104">Di seguito viene offerta una panoramica dei passaggi di configurazione principali per un servizio di bilanciamento del carico pubblico Basic.</span><span class="sxs-lookup"><span data-stu-id="501fd-104">The following is an overview of the main configuration steps for a basic public load balancer.</span></span> <span data-ttu-id="501fd-105">I passaggi per un servizio di bilanciamento del carico standard e un servizio di bilanciamento del carico interno sono simili.</span><span class="sxs-lookup"><span data-stu-id="501fd-105">The steps for a standard load balancer and for an internal load balancer will be similar.</span></span> <span data-ttu-id="501fd-106">È necessario configurare quattro elementi principali:</span><span class="sxs-lookup"><span data-stu-id="501fd-106">There are essentially four things we need to setup:</span></span>

- <span data-ttu-id="501fd-107">Server back-end per l'elaborazione delle richieste</span><span class="sxs-lookup"><span data-stu-id="501fd-107">Backend servers to process requests</span></span>
- <span data-ttu-id="501fd-108">Indirizzo IP pubblico</span><span class="sxs-lookup"><span data-stu-id="501fd-108">Public IP address</span></span>
- <span data-ttu-id="501fd-109">Probe di integrità</span><span class="sxs-lookup"><span data-stu-id="501fd-109">Health probe</span></span>
- <span data-ttu-id="501fd-110">Regole del servizio di bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="501fd-110">Load balancer rules</span></span>

### <a name="backend-servers"></a><span data-ttu-id="501fd-111">Server back-end</span><span class="sxs-lookup"><span data-stu-id="501fd-111">Backend servers</span></span>

<span data-ttu-id="501fd-112">Per prima cosa, è necessario configurare il pool di VM back-end.</span><span class="sxs-lookup"><span data-stu-id="501fd-112">First, you need to configure your backend VM pool.</span></span> <span data-ttu-id="501fd-113">Le VM devono essere incluse nello stesso set di disponibilità e avere un proprio indirizzo IP pubblico, nonostante questo non venga effettivamente usato dagli endpoint pubblici.</span><span class="sxs-lookup"><span data-stu-id="501fd-113">The VMs should be in the same availability set and have their own public IP address (although this will not actually be used by your public endpoints).</span></span>

<span data-ttu-id="501fd-114">È necessario creare una nuova rete virtuale e definire una subnet da usare per il pool di VM.</span><span class="sxs-lookup"><span data-stu-id="501fd-114">You must create a new virtual network and define a subnet for the VM pool to use.</span></span>

 <span data-ttu-id="501fd-115">In presenza di più VM che offrono gli stessi servizi è consigliabile usare un **gruppo di sicurezza di rete (NSG)** per garantire che nell'intero pool di VM vengano applicate le stesse regole del firewall (sebbene questa operazione non sia inclusa nel processo di bilanciamento del carico corrente).</span><span class="sxs-lookup"><span data-stu-id="501fd-115">When you have multiple VMs providing the same services, you should use a **network security group (NSG)** to ensure that the same firewall rules are in place across the VM pool (although this is not part of the actual load-balancing process).</span></span> <span data-ttu-id="501fd-116">Per le VM che ospitano applicazioni Web, ad esempio, sarà necessario creare regole di sicurezza in ingresso sulla porta 80 per HTTP o sulla porta 8080 per HTTPS.</span><span class="sxs-lookup"><span data-stu-id="501fd-116">For example, for VMs hosting web applications, you will need to create inbound security rules on port 80 for HTTP or port 8080 for HTTPS.</span></span>

### <a name="public-ip-address"></a><span data-ttu-id="501fd-117">Indirizzo IP pubblico</span><span class="sxs-lookup"><span data-stu-id="501fd-117">Public IP address</span></span>

<span data-ttu-id="501fd-118">Quando si crea un servizio di bilanciamento del carico pubblico Basic usando il portale, l'**indirizzo IP pubblico** viene configurato automaticamente come front-end del servizio di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="501fd-118">When you create a public basic load balancer using the portal, the **public IP address** is automatically configured as the load balancer front end.</span></span>

<span data-ttu-id="501fd-119">La configurazione del servizio di bilanciamento del carico include il **pool di indirizzi back-end** che contiene gli indirizzi IP delle schede di interfaccia di rete virtuali di ogni VM che sono connesse al servizio di bilanciamento del carico e vengono usate per distribuire il traffico alle VM.</span><span class="sxs-lookup"><span data-stu-id="501fd-119">Part of the configuration of the load balancer is the **backend address pool**, containing the IP addresses of each VM's virtual NICs that are connected to the load balancer and used to distribute traffic to the VMs.</span></span>

### <a name="health-probe"></a><span data-ttu-id="501fd-120">Probe di integrità</span><span class="sxs-lookup"><span data-stu-id="501fd-120">Health probe</span></span>

<span data-ttu-id="501fd-121">Il probe di integrità aggiunge o rimuove in modo dinamico le VM nella rotazione del servizio di bilanciamento del carico in base alla rispettiva risposta ai controlli di integrità.</span><span class="sxs-lookup"><span data-stu-id="501fd-121">The health probe dynamically adds or removes VMs from the load balancer rotation based on their response to health checks.</span></span> <span data-ttu-id="501fd-122">Per impostazione predefinita, i tentativi di probe vengono eseguiti ogni 15 secondi.</span><span class="sxs-lookup"><span data-stu-id="501fd-122">By default, there are 15 seconds between probe attempts.</span></span> <span data-ttu-id="501fd-123">Dopo due errori di probe consecutivi, la VM viene considerata non integra e il traffico non viene instradato fino a quando il server non torna online.</span><span class="sxs-lookup"><span data-stu-id="501fd-123">After two consecutive probe failures, a VM is considered unhealthy and traffic won't be routed there until the server comes back online.</span></span>

### <a name="rules"></a><span data-ttu-id="501fd-124">Regole</span><span class="sxs-lookup"><span data-stu-id="501fd-124">Rules</span></span>

<span data-ttu-id="501fd-125">Le regole di bilanciamento del carico identificano le porte su cui è in ascolto il servizio di bilanciamento del carico e le porte usate per l'invio del traffico al set back-end delle VM.</span><span class="sxs-lookup"><span data-stu-id="501fd-125">The load balancer rules identify the port(s) that the load balancer is listening on, and the port(s) used to send traffic to the back end set of VMs.</span></span> <span data-ttu-id="501fd-126">È necessaria almeno una regola per instradare il traffico.</span><span class="sxs-lookup"><span data-stu-id="501fd-126">You need at least one rule to route traffic.</span></span>
