<span data-ttu-id="783b7-101">È importante fare alcune considerazioni sulle prestazioni di archiviazione nell'architettura.</span><span class="sxs-lookup"><span data-stu-id="783b7-101">It's important to include storage performance considerations in your architecture.</span></span> <span data-ttu-id="783b7-102">Proprio come la latenza di rete, una riduzione delle prestazioni a livello di archiviazione può compromettere l'esperienza degli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="783b7-102">Just like network latency, poor performance at the storage layer can impact your end-users' experience.</span></span> <span data-ttu-id="783b7-103">In che modo si potrebbe ottimizzare l'archiviazione dei dati?</span><span class="sxs-lookup"><span data-stu-id="783b7-103">How would you optimize your data storage?</span></span> <span data-ttu-id="783b7-104">Quali aspetti occorre prendere in considerazione per assicurarsi di non introdurre colli di bottiglia in termini di archiviazione nell'architettura?</span><span class="sxs-lookup"><span data-stu-id="783b7-104">What things do you need to consider to ensure that you're not introducing storage bottlenecks into your architecture?</span></span> <span data-ttu-id="783b7-105">Qui di seguito viene spiegato come ottimizzare le prestazioni dell'archiviazione nell'architettura.</span><span class="sxs-lookup"><span data-stu-id="783b7-105">Here, we'll take a look at how to optimize your storage performance in your architecture.</span></span>

## <a name="optimize-virtual-machine-storage-performance"></a><span data-ttu-id="783b7-106">Ottimizzare le prestazioni di archiviazione della macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="783b7-106">Optimize virtual machine storage performance</span></span>

<span data-ttu-id="783b7-107">Innanzitutto verrà spiegato come ottimizzare l'archiviazione per le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="783b7-107">Let's first look at optimizing storage for virtual machines.</span></span> <span data-ttu-id="783b7-108">L'archiviazione su disco svolge un ruolo fondamentale nelle prestazioni delle macchine virtuali. La scelta del tipo di disco più idoneo per l'applicazione è una decisione importante.</span><span class="sxs-lookup"><span data-stu-id="783b7-108">Disk storage plays a critical role in the performance of your virtual machines, and selecting the right disk type for your application is an important decision.</span></span>

<span data-ttu-id="783b7-109">Applicazioni diverse hanno requisiti di archiviazione diversi.</span><span class="sxs-lookup"><span data-stu-id="783b7-109">Different applications are going to have different storage requirements.</span></span> <span data-ttu-id="783b7-110">L'applicazione potrebbe essere sensibile alla latenza delle letture e scritture del disco, oppure potrebbe richiedere di gestire un numero elevato di operazioni di input/output al secondo (IOPS) o una maggiore velocità effettiva complessiva del disco.</span><span class="sxs-lookup"><span data-stu-id="783b7-110">Your application may be sensitive to latency of disk reads and writes or it may require the ability to handle a large number of input/output operations per second (IOPS) or greater overall disk throughput.</span></span>

<span data-ttu-id="783b7-111">Quando si compila un carico di lavoro IaaS, quale tipo di disco è opportuno usare?</span><span class="sxs-lookup"><span data-stu-id="783b7-111">When building an IaaS workload, which type of disk should you use?</span></span> <span data-ttu-id="783b7-112">Vi sono quattro opzioni:</span><span class="sxs-lookup"><span data-stu-id="783b7-112">There are four options:</span></span>

- <span data-ttu-id="783b7-113">**Archiviazione SSD locale**: ogni macchina virtuale ha un disco temporaneo supportato da un'archiviazione SSD locale.</span><span class="sxs-lookup"><span data-stu-id="783b7-113">**Local SSD storage** - Each VM has a temporary disk that is backed by local SSD storage.</span></span> <span data-ttu-id="783b7-114">Le dimensioni del disco variano a seconda delle dimensioni della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="783b7-114">The size of this disk varies depending on the size of the virtual machine.</span></span> <span data-ttu-id="783b7-115">Poiché si tratta di un disco SSD locale, le prestazioni sono elevate, ma può verificarsi una perdita di dati durante un evento di manutenzione o una ridistribuzione della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="783b7-115">Since this disk is local SSD, the performance is high, but data may be lost during a maintenance event or a redeployment of the VM.</span></span> <span data-ttu-id="783b7-116">Questo disco è adatto solo per l'archiviazione temporanea dei dati che non sono necessari in modo permanente.</span><span class="sxs-lookup"><span data-stu-id="783b7-116">This disk is only suitable for temporary storage of data that you do not need permanently.</span></span> <span data-ttu-id="783b7-117">Questo disco è molto utile per il file di paging o di scambio e per elementi quali tempdb in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="783b7-117">This disk is great for the page or swap file, and for things like tempdb in SQL Server.</span></span> <span data-ttu-id="783b7-118">Per questa risorsa di archiviazione non vengono addebitati costi.</span><span class="sxs-lookup"><span data-stu-id="783b7-118">There is no charge for this storage.</span></span> <span data-ttu-id="783b7-119">È inclusa nel costo della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="783b7-119">It's included in the cost of the VM.</span></span>

- <span data-ttu-id="783b7-120">**Archiviazione HDD standard**: si tratta di una risorsa di archiviazione su disco con spindle e può essere adatta quando l'applicazione non è condizionata da una velocità effettiva minore o una latenza incoerente.</span><span class="sxs-lookup"><span data-stu-id="783b7-120">**Standard storage HDD** - This is spindle disk storage and may fit well where your application is not bound by inconsistent latency or lower levels of throughput.</span></span> <span data-ttu-id="783b7-121">Un carico di lavoro di sviluppo/test in cui non sono necessarie prestazioni garantite è un'applicazione ideale per questo tipo di disco.</span><span class="sxs-lookup"><span data-stu-id="783b7-121">A dev/test workload where guaranteed performance isn't needed is a great use case for this disk type.</span></span>

- <span data-ttu-id="783b7-122">**Archiviazione SSD standard**: si tratta di una risorsa di archiviazione basata su SSD con la bassa latenza delle unità SSD, ma livelli inferiori di velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="783b7-122">**Standard storage SSD** - This is SSD backed storage and has the low latency of SSD but lower levels of throughput.</span></span> <span data-ttu-id="783b7-123">Un server Web non di produzione rappresenta un buon caso d'uso per questo tipo di disco.</span><span class="sxs-lookup"><span data-stu-id="783b7-123">A non-production web server would be a good use case for this disk type.</span></span>

- <span data-ttu-id="783b7-124">**Archiviazione SSD Premium**: questa risorsa di archiviazione basata su SSD è particolarmente adatta per i carichi di lavoro dell'ambiente di produzione che richiedono la massima affidabilità e una bassa latenza costante, oppure livelli elevati di operazioni di I/O al secondo e velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="783b7-124">**Premium storage SSD** - This SSD backed storage is well-suited for those workloads that are going into production, require the greatest reliability and demand consistent low latency, or need high levels of throughput and IOPS.</span></span> <span data-ttu-id="783b7-125">Poiché questi dischi possono vantare livelli superiori di prestazioni e affidabilità, sono consigliati per tutti i carichi di lavoro di produzione.</span><span class="sxs-lookup"><span data-stu-id="783b7-125">Since these disks have greater performance and reliability capabilities, they are recommended for all production workloads.</span></span>

<span data-ttu-id="783b7-126">L'archiviazione Premium può essere collegata solo a macchine virtuali di determinate dimensioni.</span><span class="sxs-lookup"><span data-stu-id="783b7-126">Premium storage can attach only to specific virtual machine (VM) sizes.</span></span> <span data-ttu-id="783b7-127">Le dimensioni che supportano l'archiviazione Premium hanno una "s" nel nome, ad esempio D2**s**_v3 o Standard_F2**s**_v2.</span><span class="sxs-lookup"><span data-stu-id="783b7-127">Premium storage capable sizes are designated with an "s" in the name, for example D2**s**_v3 or Standard_F2**s**_v2.</span></span> <span data-ttu-id="783b7-128">Qualsiasi tipo di macchina virtuale (con o senza una "s" nel nome) può essere collegata a unità SSD o HDD di archiviazione standard.</span><span class="sxs-lookup"><span data-stu-id="783b7-128">Any virtual machine type (with or without an "s" in the name) can attach standard storage HDD or SSD drives.</span></span>

<span data-ttu-id="783b7-129">È possibile effettuare lo striping dei dischi tramite una tecnologia di striping (come Spazi di archiviazione diretta in Windows o mdadm in Linux) per aumentare la velocità effettiva e le operazioni di I/O al secondo distribuendo attività tra più dischi.</span><span class="sxs-lookup"><span data-stu-id="783b7-129">Disks can be striped using a striping technology (such as Storage Spaces Direct on Windows or mdadm on Linux) to increase the throughput and IOPS by spreading disk activity across multiple disks.</span></span> <span data-ttu-id="783b7-130">Lo striping del disco consente di superare i limiti delle prestazioni dei dischi e viene spesso impiegato in sistemi database ad alte prestazioni e altri sistemi con requisiti di archiviazione intensivi.</span><span class="sxs-lookup"><span data-stu-id="783b7-130">Using disk striping allows you to really push the limits of performance for disks, and is often seen in high-performance database systems and other systems with intensive storage requirements.</span></span>

<span data-ttu-id="783b7-131">Quando ci si affida ai carichi di lavoro della macchina virtuale, è necessario valutare i requisiti delle prestazioni dell'applicazione per determinare lo spazio di archiviazione sottostante di cui verrà eseguito il provisioning per le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="783b7-131">When relying on virtual machine workloads, you'll need to evaluate the performance requirements of your application to determine the underlying storage you'll provision for your virtual machines.</span></span>

## <a name="optimize-storage-performance-for-your-application"></a><span data-ttu-id="783b7-132">Ottimizzare le prestazioni di archiviazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="783b7-132">Optimize storage performance for your application</span></span>

<span data-ttu-id="783b7-133">Sebbene sia possibile usare diverse tecnologie di archiviazione per migliorare le prestazioni del disco non elaborato, è anche possibile migliorare le prestazioni di accesso ai dati a livello di applicazione.</span><span class="sxs-lookup"><span data-stu-id="783b7-133">While you can use differing storage technologies to improve the raw disk performance, you can also address the performance of access to data at the application layer.</span></span> <span data-ttu-id="783b7-134">Qui di seguito verranno esaminati alcuni modi per farlo.</span><span class="sxs-lookup"><span data-stu-id="783b7-134">Let's take a look at a few ways you can do this.</span></span>

### <a name="caching"></a><span data-ttu-id="783b7-135">Memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="783b7-135">Caching</span></span>

<span data-ttu-id="783b7-136">Un approccio comune per migliorare le prestazioni delle applicazioni è quello di integrare un livello di caching tra l'applicazione e l'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="783b7-136">A common approach to improve application performance is to integrate a caching layer between your application and your data store.</span></span> <span data-ttu-id="783b7-137">In genere, la cache archivia dati nella memoria e ne consente il recupero in modo rapido.</span><span class="sxs-lookup"><span data-stu-id="783b7-137">A cache typically stores data in memory and allows for fast retrieval.</span></span> <span data-ttu-id="783b7-138">Può trattarsi di dati usati di frequente, specificati da un database o temporanei, ad esempio lo stato utente.</span><span class="sxs-lookup"><span data-stu-id="783b7-138">This data can be frequently accessed data, data you specify from a database, or temporary data such as user state.</span></span> <span data-ttu-id="783b7-139">È possibile controllare il tipo di dati archiviati, la frequenza di aggiornamento e la scadenza.</span><span class="sxs-lookup"><span data-stu-id="783b7-139">You'll have control over the type of data stored, how often it refreshes, and when it expires.</span></span> <span data-ttu-id="783b7-140">Condividendo questa cache nella stessa area dell'applicazione e del database, sarà possibile ridurre la latenza complessiva tra i due.</span><span class="sxs-lookup"><span data-stu-id="783b7-140">By co-locating this cache in the same region as your application and database, you'll reduce the overall latency between the two.</span></span> <span data-ttu-id="783b7-141">Il pull dei dati dalla cache sarà tendenzialmente più rapido rispetto al recupero degli stessi dati da un database. Di conseguenza, usando un livello di caching è possibile migliorare notevolmente le prestazioni complessive dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="783b7-141">Pulling data out of the cache will almost always be faster than retrieving the same data from a database, so by using a caching layer you can substantially improve the overall performance of your application.</span></span> <span data-ttu-id="783b7-142">La figura seguente illustra come un'applicazione recupera i dati da un database, li memorizza in una cache e usa il valore memorizzato nella cache in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="783b7-142">The following illustration shows how an application retrieves data from a database, stores it in a cache, and uses the cached value as needed.</span></span>

![Figura che mostra come il recupero dei dati dalla cache sia più veloce rispetto al recupero da un database.](../media/4-cache.png)

<span data-ttu-id="783b7-144">Cache Redis di Azure è un servizio di caching di Azure che archivia dati in memoria.</span><span class="sxs-lookup"><span data-stu-id="783b7-144">Azure Redis Cache is a caching service on Azure that stores data in memory.</span></span> <span data-ttu-id="783b7-145">È un servizio basato sulla cache Redis open source ed è un'offerta completamente gestita di Microsoft.</span><span class="sxs-lookup"><span data-stu-id="783b7-145">It's based upon the open-source Redis cache and is a fully managed service offering by Microsoft.</span></span> <span data-ttu-id="783b7-146">È necessario selezionare il livello di prestazioni desiderato e configurare l'applicazione per usare il servizio.</span><span class="sxs-lookup"><span data-stu-id="783b7-146">You select the performance tier that you require and configure your application to use the service.</span></span>

### <a name="polyglot-persistence"></a><span data-ttu-id="783b7-147">Persistenza poliglotta</span><span class="sxs-lookup"><span data-stu-id="783b7-147">Polyglot persistence</span></span>

<span data-ttu-id="783b7-148">La persistenza poliglotta presuppone l'uso di tecnologie di archiviazione dati diverse per gestire i requisiti di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="783b7-148">Polyglot persistence is the usage of different data storage technologies to handle your storage requirements.</span></span>

<span data-ttu-id="783b7-149">Si consideri un esempio di e-commerce.</span><span class="sxs-lookup"><span data-stu-id="783b7-149">Consider an e-commerce example.</span></span> <span data-ttu-id="783b7-150">È possibile archiviare gli asset dell'applicazione in un archivio BLOB, recensioni dei prodotti e consigli in un archivio NoSQL e i dati del profilo o dell'account in un database SQL.</span><span class="sxs-lookup"><span data-stu-id="783b7-150">You may store application assets in a blob store, product reviews and recommendations in a NoSQL store, and user profile or account data in a SQL database.</span></span> <span data-ttu-id="783b7-151">La figura seguente illustra come un'applicazione potrebbe usare più tecniche di archiviazione per archiviare tipi di dati diversi.</span><span class="sxs-lookup"><span data-stu-id="783b7-151">The following illustration shows how an application might use multiple data storage techniques to store different types of data.</span></span>

![Figura che mostra l'utilizzo di diversi metodi di archiviazione dei dati all'interno della stessa applicazione per migliorare le prestazioni e ridurre i costi.](../media/4-polyglotpersistence.png)

<span data-ttu-id="783b7-153">Questo è importante perché i diversi archivi dati sono progettati per casi d'uso specifici o potrebbero essere più accessibili per via dei costi.</span><span class="sxs-lookup"><span data-stu-id="783b7-153">This is important, as different data stores are designed for certain use cases or may be more accessible because of cost.</span></span> <span data-ttu-id="783b7-154">Ad esempio, l'archiviazione di BLOB in un database SQL può essere costosa e l'accesso potrebbe essere più lento rispetto a un archivio BLOB.</span><span class="sxs-lookup"><span data-stu-id="783b7-154">As an example, storing blobs in a SQL database may be costly and slower to access than directly from a blob store.</span></span>

<span data-ttu-id="783b7-155">Il mantenimento della coerenza dei dati tra archivi dati distribuiti può costituire una sfida significativa.</span><span class="sxs-lookup"><span data-stu-id="783b7-155">Maintaining data consistency across distributed data stores can be a significant challenge.</span></span> <span data-ttu-id="783b7-156">Il problema è che strategie come la serializzazione e il blocco funzionano solo se tutte le istanze dell'applicazione condividono lo stesso archivio dati e l'applicazione è progettata per garantire blocchi molto brevi.</span><span class="sxs-lookup"><span data-stu-id="783b7-156">The issue is that strategies such as serialization and locking only work well if all application instances share the same data store, and the application is designed to ensure that the locks are very short-lived.</span></span> <span data-ttu-id="783b7-157">Tuttavia, se i dati vengono partizionati o replicati in diversi archivi dati, il blocco e la serializzazione dell'accesso ai dati per mantenere la coerenza può causare un sovraccarico costoso che influisce su velocità effettiva, tempo di risposta e scalabilità di un sistema.</span><span class="sxs-lookup"><span data-stu-id="783b7-157">However, if data is partitioned or replicated across different data stores, locking and serializing data access to maintain consistency can become an expensive overhead that impacts the throughput, response time, and scalability of a system.</span></span> <span data-ttu-id="783b7-158">Di conseguenza, le più moderne applicazioni distribuite non bloccano i dati che modificano e adottano invece un approccio più flessibile riguardo alla coerenza, noto come coerenza finale.</span><span class="sxs-lookup"><span data-stu-id="783b7-158">Therefore, most modern distributed applications do not lock the data that they modify, and they take a rather more relaxed approach to consistency, known as eventual consistency.</span></span>

<span data-ttu-id="783b7-159">Il concetto di coerenza finale indica che, in assenza di ulteriori scritture, gli archivi dati di replica finiranno per convergere.</span><span class="sxs-lookup"><span data-stu-id="783b7-159">Eventual consistency means that replica data stores will eventually converge if there are no further writes.</span></span> <span data-ttu-id="783b7-160">Se viene eseguita un'operazione di scrittura su uno di questi archivi dati, le operazioni di lettura da un altro archivio potrebbero fornire dati non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="783b7-160">If a write is made to one of the data stores, reads from another may provide slightly out-of-date data.</span></span> <span data-ttu-id="783b7-161">La coerenza finale consente una scalabilità superiore poiché la latenza per le operazioni di lettura e scrittura è bassa ed elimina i tempi di attesa per verificare se le informazioni sono coerenti tra tutti gli archivi.</span><span class="sxs-lookup"><span data-stu-id="783b7-161">Eventual consistency enables higher scale because there is a low latency for reads and writes, rather than waiting to check if information is consistent across all stores.</span></span>

## <a name="lamna-healthcare-example"></a><span data-ttu-id="783b7-162">Esempio: Lamna Healthcare</span><span class="sxs-lookup"><span data-stu-id="783b7-162">Lamna Healthcare example</span></span>

<span data-ttu-id="783b7-163">Il sistema di prenotazione pazienti di Lamna Healthcare è ospitato in due aree di Azure, l'Europa occidentale e l'Australia orientale.</span><span class="sxs-lookup"><span data-stu-id="783b7-163">Lamna Healthcare's patient booking system is hosted across two Azure regions, West Europe and Australia East.</span></span> <span data-ttu-id="783b7-164">L'azienda usa macchine virtuali come nodi front-end per distribuire il sito Web, mentre il database SQL di Azure viene distribuito in Europa occidentale come primario e in Australia orientale come secondario leggibile.</span><span class="sxs-lookup"><span data-stu-id="783b7-164">They're using virtual machines as the front-end nodes to deploy their website, and have Azure SQL DB deployed in West Europe as primary and Australia East as a readable secondary.</span></span> <span data-ttu-id="783b7-165">I nodi front-end non richiedono livelli elevati di velocità effettiva del disco, ma prestazioni di latenza coerenti e affidabilità in produzione, e usano l'archiviazione SSD Premium.</span><span class="sxs-lookup"><span data-stu-id="783b7-165">Their front-end nodes don't require high levels of disk throughput, but do require consistent latency performance and production reliability and have used Premium SSD backed storage.</span></span>

<span data-ttu-id="783b7-166">Ospitano un'istanza di Cache Redis in locale in ogni area di Azure per archiviare le richieste più comuni degli utenti e la disponibilità dei dottori.</span><span class="sxs-lookup"><span data-stu-id="783b7-166">They are hosting an Azure Redis Cache locally in each Azure region to store the common user requests and availability of doctors.</span></span> <span data-ttu-id="783b7-167">È stata implementata la memorizzazione nella cache in modo da ottimizzare le prestazioni delle attività di lettura dati più comuni osservate nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="783b7-167">Caching has been implemented to optimize the performance of the most common data read activities observed on the application.</span></span>

<span data-ttu-id="783b7-168">Sono stati descritti alcuni esempi su come migliorare le prestazioni di archiviazione, a livello di infrastruttura scegliendo l'architettura disco più corretta e a livello di applicazione usando la memorizzazione nella cache e scegliendo la piattaforma più idonea per i dati.</span><span class="sxs-lookup"><span data-stu-id="783b7-168">We've covered a few examples of how you can improve storage performance in your infrastructure layer by choosing the right disk architecture and at the application level through the use of caching and selecting the right data platform for your data.</span></span> <span data-ttu-id="783b7-169">Una soluzione strutturata in modo appropriato garantisce il migliore accesso possibile ai dati.</span><span class="sxs-lookup"><span data-stu-id="783b7-169">A properly architected solution will ensure that access to data performs as well as possible.</span></span>