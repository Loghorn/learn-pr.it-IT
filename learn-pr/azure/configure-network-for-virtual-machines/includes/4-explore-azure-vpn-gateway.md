<span data-ttu-id="32ce2-101">Per integrare l'ambiente locale con Azure, è necessario poter creare una connessione crittografata.</span><span class="sxs-lookup"><span data-stu-id="32ce2-101">To integrate your on-premises environment with Azure, you need the ability to create an encrypted connection.</span></span> <span data-ttu-id="32ce2-102">È possibile connettersi tramite la rete Internet pubblica o tramite un collegamento dedicato.</span><span class="sxs-lookup"><span data-stu-id="32ce2-102">You can connect over the public internet or over a dedicated link.</span></span> <span data-ttu-id="32ce2-103">In questo caso viene illustrato il gateway VPN di Azure, che rende disponibile un endpoint per le connessioni in ingresso dagli ambienti locali.</span><span class="sxs-lookup"><span data-stu-id="32ce2-103">Here, we'll look at Azure VPN Gateway, which provides an endpoint for incoming connections from on-premises environments.</span></span>

<span data-ttu-id="32ce2-104">È stata configurata una rete virtuale di Azure ed è necessario assicurarsi che i trasferimenti di dati da Azure al sito e tra le reti virtuali di Azure siano crittografati.</span><span class="sxs-lookup"><span data-stu-id="32ce2-104">You have set up an Azure virtual network and need to ensure that any data transfers from Azure to your site and between Azure virtual networks are encrypted.</span></span> <span data-ttu-id="32ce2-105">È anche necessario definire come connettere le reti virtuali tra aree e sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="32ce2-105">You also need to know how to connect virtual networks between regions and subscriptions.</span></span>

## <a name="describe-a-vpn-gateway"></a><span data-ttu-id="32ce2-106">Descrivere un gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-106">Describe a VPN gateway</span></span>

<span data-ttu-id="32ce2-107">Un gateway VPN di Azure rende disponibile un endpoint per le connessioni crittografate in ingresso dall'ambiente locale ad Azure tramite Internet.</span><span class="sxs-lookup"><span data-stu-id="32ce2-107">An Azure VPN gateway provides an endpoint for incoming encrypted connections from on-premises locations to Azure over the internet.</span></span> <span data-ttu-id="32ce2-108">Può anche inviare traffico crittografato tra reti virtuali di Azure tramite la rete dedicata di Microsoft, che collega i data center di Azure in varie aree.</span><span class="sxs-lookup"><span data-stu-id="32ce2-108">It can also send encrypted traffic between Azure virtual networks over Microsoft's dedicated network that links Azure datacenters in different regions.</span></span> <span data-ttu-id="32ce2-109">Questa configurazione consente di collegare in modo sicuro macchine virtuali e servizi in aree diverse.</span><span class="sxs-lookup"><span data-stu-id="32ce2-109">This configuration allows you to link virtual machines and services in different regions securely.</span></span>

<span data-ttu-id="32ce2-110">Ogni rete virtuale può avere un solo gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-110">Each virtual network can have only one VPN gateway.</span></span> <span data-ttu-id="32ce2-111">e tutte le connessioni al gateway VPN condividono la larghezza di banda di rete disponibile.</span><span class="sxs-lookup"><span data-stu-id="32ce2-111">All connections to that VPN gateway share the available network bandwidth.</span></span>

<span data-ttu-id="32ce2-112">In ogni gateway di rete virtuale sono presenti due o più macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="32ce2-112">Within each virtual network gateway are two or more virtual machines (VMs).</span></span> <span data-ttu-id="32ce2-113">Le macchine virtuali sono state distribuite in una subnet speciale definita dall'utente e denominata _subnet del gateway_.</span><span class="sxs-lookup"><span data-stu-id="32ce2-113">These VMs have been deployed to a special subnet that you specify, called the _gateway subnet_.</span></span> <span data-ttu-id="32ce2-114">Contengono le tabelle di routing per le connessioni ad altre reti, nonché servizi gateway specifici.</span><span class="sxs-lookup"><span data-stu-id="32ce2-114">They contain routing tables for connections to other networks, along with specific gateway services.</span></span> <span data-ttu-id="32ce2-115">Le macchine virtuali e la subnet del gateway sono simili a un dispositivo di rete con protezione avanzata.</span><span class="sxs-lookup"><span data-stu-id="32ce2-115">These VMs and the gateway subnet are similar to a hardened network device.</span></span> <span data-ttu-id="32ce2-116">Non è necessario configurare direttamente le macchine virtuali, né distribuire risorse aggiuntive nella subnet del gateway.</span><span class="sxs-lookup"><span data-stu-id="32ce2-116">You don't need to configure these VMs directly and should not deploy any additional resources into the gateway subnet.</span></span>

<span data-ttu-id="32ce2-117">La creazione di un gateway di rete virtuale può richiedere diverso tempo, ed è quindi importante pianificare le attività in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="32ce2-117">Creating a virtual network gateway can take some time to complete, so it's vital that you plan appropriately.</span></span> <span data-ttu-id="32ce2-118">Quando si crea un gateway di rete virtuale, il processo di provisioning genera le macchine virtuali del gateway e le distribuisce nella subnet del gateway.</span><span class="sxs-lookup"><span data-stu-id="32ce2-118">When you create a virtual network gateway, the provisioning process generates the gateway VMs and deploys them to the gateway subnet.</span></span> <span data-ttu-id="32ce2-119">Le impostazioni delle macchine virtuali saranno quelle configurate nel gateway.</span><span class="sxs-lookup"><span data-stu-id="32ce2-119">These VMs will have the settings that you configure on the gateway.</span></span>

<span data-ttu-id="32ce2-120">Un'impostazione importante è il **_tipo di gateway_**, che per un gateway VPN sarà di tipo "vpn".</span><span class="sxs-lookup"><span data-stu-id="32ce2-120">A key setting is the **_gateway type_**, which for a VPN gateway will be of type "vpn".</span></span> <span data-ttu-id="32ce2-121">Le opzioni per i gateway VPN includono:</span><span class="sxs-lookup"><span data-stu-id="32ce2-121">Options for VPN gateways include:</span></span>

- <span data-ttu-id="32ce2-122">Connessioni da rete a rete tramite tunneling VPN IPsec/IKE, che collega i gateway VPN ad altri gateway VPN.</span><span class="sxs-lookup"><span data-stu-id="32ce2-122">Network-to-network connections over IPsec/IKE VPN tunneling, linking VPN gateways to other VPN gateways.</span></span>

- <span data-ttu-id="32ce2-123">Tunneling VPN IPsec/IKE cross-premise, per la connessione di reti locali ad Azure tramite dispositivi VPN dedicati e la creazione di connessioni da sito a sito.</span><span class="sxs-lookup"><span data-stu-id="32ce2-123">Cross-premises IPsec/IKE VPN tunneling, for connecting on-premises networks to Azure through dedicated VPN devices to create site-to-site connections.</span></span>

- <span data-ttu-id="32ce2-124">Connessioni da punto a sito tramite IKEv2 o SSTP, per collegare i computer client alle risorse in Azure.</span><span class="sxs-lookup"><span data-stu-id="32ce2-124">Point-to-site connections over IKEv2 or SSTP, to link client computers to resources in Azure.</span></span>

<span data-ttu-id="32ce2-125">Per la pianificazione del gateway VPN vanno considerati i fattori seguenti.</span><span class="sxs-lookup"><span data-stu-id="32ce2-125">Now, let's look at the factors you need to consider for planning your VPN gateway.</span></span>

## <a name="plan-a-vpn-gateway"></a><span data-ttu-id="32ce2-126">Pianificare un gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-126">Plan a VPN gateway</span></span>

<span data-ttu-id="32ce2-127">Quando si pianifica un gateway VPN, è utile valutare tre architetture:</span><span class="sxs-lookup"><span data-stu-id="32ce2-127">When you're planning a VPN gateway, there are three architectures to consider:</span></span>

- <span data-ttu-id="32ce2-128">Da punto a sito tramite Internet</span><span class="sxs-lookup"><span data-stu-id="32ce2-128">Point to site over the internet</span></span>
- <span data-ttu-id="32ce2-129">Da sito a sito tramite Internet</span><span class="sxs-lookup"><span data-stu-id="32ce2-129">Site to site over the internet</span></span>
- <span data-ttu-id="32ce2-130">Da sito a sito tramite una rete dedicata, ad esempio Azure ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="32ce2-130">Site to site over a dedicated network, such as Azure ExpressRoute</span></span>

### <a name="planning-factors"></a><span data-ttu-id="32ce2-131">Fattori di pianificazione</span><span class="sxs-lookup"><span data-stu-id="32ce2-131">Planning factors</span></span>

<span data-ttu-id="32ce2-132">I fattori da tenere in considerazione durante il processo di pianificazione sono:</span><span class="sxs-lookup"><span data-stu-id="32ce2-132">Factors that you need to cover during your planning process include:</span></span>

- <span data-ttu-id="32ce2-133">Velocità effettiva: Mbps o Gbps</span><span class="sxs-lookup"><span data-stu-id="32ce2-133">Throughput - Mbps or Gbps</span></span>
- <span data-ttu-id="32ce2-134">Backbone: Internet o privato?</span><span class="sxs-lookup"><span data-stu-id="32ce2-134">Backbone - internet or private?</span></span>
- <span data-ttu-id="32ce2-135">Disponibilità di un indirizzo IP (statico) pubblico</span><span class="sxs-lookup"><span data-stu-id="32ce2-135">Availability of a public (static) IP address</span></span>
- <span data-ttu-id="32ce2-136">Compatibilità del dispositivo VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-136">VPN device compatibility</span></span>
- <span data-ttu-id="32ce2-137">Più connessioni client o collegamento da sito a sito?</span><span class="sxs-lookup"><span data-stu-id="32ce2-137">Multiple client connections or a site-to-site link?</span></span>
- <span data-ttu-id="32ce2-138">Tipo di gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-138">VPN gateway type</span></span>
- <span data-ttu-id="32ce2-139">SKU del gateway VPN di Azure</span><span class="sxs-lookup"><span data-stu-id="32ce2-139">Azure VPN Gateway SKU</span></span>

<span data-ttu-id="32ce2-140">La tabella seguente mostra un riepilogo delle problematiche di pianificazione.</span><span class="sxs-lookup"><span data-stu-id="32ce2-140">The following table summarizes some of these planning issues.</span></span> <span data-ttu-id="32ce2-141">Le altre opzioni vengono illustrate più avanti.</span><span class="sxs-lookup"><span data-stu-id="32ce2-141">The remainder are discussed later.</span></span>

|                           |  <span data-ttu-id="32ce2-142">Da punto a sito</span><span class="sxs-lookup"><span data-stu-id="32ce2-142">Point to site</span></span>            | <span data-ttu-id="32ce2-143">Da sito a sito</span><span class="sxs-lookup"><span data-stu-id="32ce2-143">Site to site</span></span>                          |  <span data-ttu-id="32ce2-144">ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="32ce2-144">ExpressRoute</span></span>                 |
| -------------             | -------------             | -------------                         | ---------                     |
| <span data-ttu-id="32ce2-145">Servizi supportati di Azure</span><span class="sxs-lookup"><span data-stu-id="32ce2-145">Azure supported services</span></span>  | <span data-ttu-id="32ce2-146">Servizi cloud e macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="32ce2-146">Cloud services and VMs</span></span>    | <span data-ttu-id="32ce2-147">Servizi cloud e macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="32ce2-147">Cloud services and VMs</span></span>                | <span data-ttu-id="32ce2-148">Tutti i servizi supportati</span><span class="sxs-lookup"><span data-stu-id="32ce2-148">All supported services</span></span>        |
| <span data-ttu-id="32ce2-149">Larghezza di banda tipica</span><span class="sxs-lookup"><span data-stu-id="32ce2-149">Typical bandwidth</span></span>         | <span data-ttu-id="32ce2-150">Dipende dallo SKU del gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-150">Depends on VPN Gateway SKU</span></span>    | <span data-ttu-id="32ce2-151">Fino a 1 Gbps con aggregazione</span><span class="sxs-lookup"><span data-stu-id="32ce2-151">Up to 1 Gbps with aggregation</span></span>         | <span data-ttu-id="32ce2-152">Da 50 Mbps a 10 Gbps</span><span class="sxs-lookup"><span data-stu-id="32ce2-152">From 50 Mbps to 10 Gbps</span></span>       |
| <span data-ttu-id="32ce2-153">Protocolli supportati</span><span class="sxs-lookup"><span data-stu-id="32ce2-153">Protocols supported</span></span>       | <span data-ttu-id="32ce2-154">SSTP e IPSec</span><span class="sxs-lookup"><span data-stu-id="32ce2-154">SSTP and IPsec</span></span>            | <span data-ttu-id="32ce2-155">IPsec</span><span class="sxs-lookup"><span data-stu-id="32ce2-155">IPsec</span></span>                                 | <span data-ttu-id="32ce2-156">Connessione diretta, reti VLAN</span><span class="sxs-lookup"><span data-stu-id="32ce2-156">Direct connection, VLANs</span></span>      |
| <span data-ttu-id="32ce2-157">Routing</span><span class="sxs-lookup"><span data-stu-id="32ce2-157">Routing</span></span>                   | <span data-ttu-id="32ce2-158">RouteBased (dinamico)</span><span class="sxs-lookup"><span data-stu-id="32ce2-158">RouteBased (dynamic)</span></span>      | <span data-ttu-id="32ce2-159">PolicyBased (statico) e RouteBased</span><span class="sxs-lookup"><span data-stu-id="32ce2-159">PolicyBased (static) and RouteBased</span></span>   | <span data-ttu-id="32ce2-160">BGP</span><span class="sxs-lookup"><span data-stu-id="32ce2-160">BGP</span></span>                           |
| <span data-ttu-id="32ce2-161">Resilienza connessione</span><span class="sxs-lookup"><span data-stu-id="32ce2-161">Connection resiliency</span></span>     | <span data-ttu-id="32ce2-162">Modello attivo/passivo</span><span class="sxs-lookup"><span data-stu-id="32ce2-162">Active-passive</span></span>            | <span data-ttu-id="32ce2-163">Modello attivo/passivo o attivo/attivo</span><span class="sxs-lookup"><span data-stu-id="32ce2-163">Active-passive or active-active</span></span>       | <span data-ttu-id="32ce2-164">Modello attivo/attivo</span><span class="sxs-lookup"><span data-stu-id="32ce2-164">Active-active</span></span>                 |
| <span data-ttu-id="32ce2-165">Caso d'uso</span><span class="sxs-lookup"><span data-stu-id="32ce2-165">Use case</span></span>                  | <span data-ttu-id="32ce2-166">Testing e creazione prototipi</span><span class="sxs-lookup"><span data-stu-id="32ce2-166">Testing and prototyping</span></span>   | <span data-ttu-id="32ce2-167">Sviluppo, test e produzione su scala ridotta</span><span class="sxs-lookup"><span data-stu-id="32ce2-167">Dev, test and small-scale production</span></span>  | <span data-ttu-id="32ce2-168">Enterprise/mission critical</span><span class="sxs-lookup"><span data-stu-id="32ce2-168">Enterprise/mission critical</span></span>   |

### <a name="gateway-skus"></a><span data-ttu-id="32ce2-169">SKU del gateway</span><span class="sxs-lookup"><span data-stu-id="32ce2-169">Gateway SKUs</span></span>

<span data-ttu-id="32ce2-170">Azure offre gli SKU seguenti per i servizi gateway:</span><span class="sxs-lookup"><span data-stu-id="32ce2-170">Azure offers the following SKUs for gateway services:</span></span>

| <span data-ttu-id="32ce2-171">SKU</span><span class="sxs-lookup"><span data-stu-id="32ce2-171">SKU</span></span>              |  <span data-ttu-id="32ce2-172">Tunnel S2S/Da rete a rete</span><span class="sxs-lookup"><span data-stu-id="32ce2-172">S2S/network-to-network tunnels</span></span> | <span data-ttu-id="32ce2-173">Connessioni da punto a sito</span><span class="sxs-lookup"><span data-stu-id="32ce2-173">P2S connections</span></span>  |  <span data-ttu-id="32ce2-174">Benchmark velocità effettiva aggregata</span><span class="sxs-lookup"><span data-stu-id="32ce2-174">Aggregate throughput benchmark</span></span>   | <span data-ttu-id="32ce2-175">Usare per</span><span class="sxs-lookup"><span data-stu-id="32ce2-175">Use for</span></span>                         |
| -------------    | -------------             | -------------    | ---------                         | ---------                       |
| <span data-ttu-id="32ce2-176">Basic</span><span class="sxs-lookup"><span data-stu-id="32ce2-176">Basic</span></span>            | <span data-ttu-id="32ce2-177">Max 10</span><span class="sxs-lookup"><span data-stu-id="32ce2-177">Max 10</span></span>                    | <span data-ttu-id="32ce2-178">Max 128</span><span class="sxs-lookup"><span data-stu-id="32ce2-178">Max 128</span></span>          | <span data-ttu-id="32ce2-179">100 Mbps</span><span class="sxs-lookup"><span data-stu-id="32ce2-179">100 Mbps</span></span>                          | <span data-ttu-id="32ce2-180">Sviluppo/test/modello di verifica</span><span class="sxs-lookup"><span data-stu-id="32ce2-180">Dev/test/POC</span></span>                    |
| <span data-ttu-id="32ce2-181">VpnGw1</span><span class="sxs-lookup"><span data-stu-id="32ce2-181">VpnGw1</span></span>           | <span data-ttu-id="32ce2-182">Max 30</span><span class="sxs-lookup"><span data-stu-id="32ce2-182">Max 30</span></span>                    | <span data-ttu-id="32ce2-183">Max 128</span><span class="sxs-lookup"><span data-stu-id="32ce2-183">Max 128</span></span>          | <span data-ttu-id="32ce2-184">650 Mbps</span><span class="sxs-lookup"><span data-stu-id="32ce2-184">650 Mbps</span></span>                          | <span data-ttu-id="32ce2-185">Carichi di lavoro di produzione/critici</span><span class="sxs-lookup"><span data-stu-id="32ce2-185">Production/critical workloads</span></span>   |
| <span data-ttu-id="32ce2-186">VpnGw2</span><span class="sxs-lookup"><span data-stu-id="32ce2-186">VpnGw2</span></span>           | <span data-ttu-id="32ce2-187">Max 30</span><span class="sxs-lookup"><span data-stu-id="32ce2-187">Max 30</span></span>                    | <span data-ttu-id="32ce2-188">Max 128</span><span class="sxs-lookup"><span data-stu-id="32ce2-188">Max 128</span></span>          | <span data-ttu-id="32ce2-189">1 Gbps</span><span class="sxs-lookup"><span data-stu-id="32ce2-189">1 Gbps</span></span>                            | <span data-ttu-id="32ce2-190">Carichi di lavoro di produzione/critici</span><span class="sxs-lookup"><span data-stu-id="32ce2-190">Production/critical workloads</span></span>   |
| <span data-ttu-id="32ce2-191">VpnGw3</span><span class="sxs-lookup"><span data-stu-id="32ce2-191">VpnGw3</span></span>           | <span data-ttu-id="32ce2-192">Max 30</span><span class="sxs-lookup"><span data-stu-id="32ce2-192">Max 30</span></span>                    | <span data-ttu-id="32ce2-193">Max 128</span><span class="sxs-lookup"><span data-stu-id="32ce2-193">Max 128</span></span>          | <span data-ttu-id="32ce2-194">1,25 Gbps</span><span class="sxs-lookup"><span data-stu-id="32ce2-194">1.25 Gbps</span></span>                          | <span data-ttu-id="32ce2-195">Carichi di lavoro di produzione/critici</span><span class="sxs-lookup"><span data-stu-id="32ce2-195">Production/critical workloads</span></span>   |

> [!Note]
> <span data-ttu-id="32ce2-196">È importante scegliere lo SKU corretto.</span><span class="sxs-lookup"><span data-stu-id="32ce2-196">It's important that you choose the right SKU.</span></span> <span data-ttu-id="32ce2-197">Se si configura il gateway VPN con uno SKU errato, sarà necessario eliminare e creare di nuovo il gateway, con una perdita di tempo significativa.</span><span class="sxs-lookup"><span data-stu-id="32ce2-197">If you have set up your VPN gateway with the wrong one, you'll have to take it down and rebuild the gateway, which can be time consuming.</span></span>

## <a name="workflow"></a><span data-ttu-id="32ce2-198">Flusso di lavoro</span><span class="sxs-lookup"><span data-stu-id="32ce2-198">Workflow</span></span>

<span data-ttu-id="32ce2-199">Quando si progetta una strategia di connettività cloud con le reti private virtuali in Azure, è consigliabile adottare il flusso di lavoro seguente:</span><span class="sxs-lookup"><span data-stu-id="32ce2-199">When designing a cloud connectivity strategy using virtual private networking on Azure, you should apply the following workflow:</span></span>

1. <span data-ttu-id="32ce2-200">Progettare la topologia di connettività, elencando gli spazi indirizzi per tutte le reti da connettere.</span><span class="sxs-lookup"><span data-stu-id="32ce2-200">Design your connectivity topology, listing the address spaces for all connecting networks.</span></span>

1. <span data-ttu-id="32ce2-201">Creare una rete virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="32ce2-201">Create an Azure virtual network.</span></span>

1. <span data-ttu-id="32ce2-202">Creare un gateway VPN per la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="32ce2-202">Create a VPN gateway for the virtual network.</span></span>

1. <span data-ttu-id="32ce2-203">Creare e configurare le connessioni a reti locali o ad altre reti virtuali, in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="32ce2-203">Create and configure connections to on-premises networks or other virtual networks, as required.</span></span>

1. <span data-ttu-id="32ce2-204">Se necessario, creare e configurare una connessione da punto a sito per il gateway VPN di Azure.</span><span class="sxs-lookup"><span data-stu-id="32ce2-204">If required, create and configure a point-to-site connection for your Azure VPN gateway.</span></span>

### <a name="design-considerations"></a><span data-ttu-id="32ce2-205">Considerazioni sulla progettazione</span><span class="sxs-lookup"><span data-stu-id="32ce2-205">Design considerations</span></span>

<span data-ttu-id="32ce2-206">Quando si progettano gateway VPN per connettere le reti virtuali, è necessario tenere conto dei fattori seguenti:</span><span class="sxs-lookup"><span data-stu-id="32ce2-206">When you design your VPN gateways to connect virtual networks, you must consider the following factors:</span></span>

- <span data-ttu-id="32ce2-207">Le subnet non possono sovrapporsi</span><span class="sxs-lookup"><span data-stu-id="32ce2-207">Subnets cannot overlap</span></span>

    <span data-ttu-id="32ce2-208">È fondamentale che una subnet in una posizione non contenga lo stesso spazio indirizzi di una subnet in un'altra posizione.</span><span class="sxs-lookup"><span data-stu-id="32ce2-208">It is vital that a subnet in one location does not contain the same address space as in another location.</span></span>

- <span data-ttu-id="32ce2-209">Gli indirizzi IP devono essere univoci</span><span class="sxs-lookup"><span data-stu-id="32ce2-209">IP addresses must be unique</span></span>

    <span data-ttu-id="32ce2-210">Non possono essere presenti due host con lo stesso indirizzo IP in posizioni diverse, in quanto non sarebbe possibile indirizzare il traffico tra questi due host e la connessione da rete a rete avrebbe esito negativo.</span><span class="sxs-lookup"><span data-stu-id="32ce2-210">You cannot have two hosts with the same IP address in different locations, as it will be impossible to route traffic between those two hosts and the network-to-network connection will fail.</span></span>

- <span data-ttu-id="32ce2-211">I gateway VPN richiedono una subnet del gateway denominata **GatewaySubnet**</span><span class="sxs-lookup"><span data-stu-id="32ce2-211">VPN gateways need a gateway subnet called **GatewaySubnet**</span></span>

    <span data-ttu-id="32ce2-212">Per funzionare, la subnet deve avere questo nome e non deve contenere altre risorse.</span><span class="sxs-lookup"><span data-stu-id="32ce2-212">It must have this name for the gateway to work, and it should not contain any other resources.</span></span>

### <a name="create-an-azure-virtual-network"></a><span data-ttu-id="32ce2-213">Creare una rete virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="32ce2-213">Create an Azure virtual network</span></span>

<span data-ttu-id="32ce2-214">Prima di creare un gateway VPN è necessario creare la rete virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="32ce2-214">Before you create a VPN gateway, you need to create the Azure virtual network.</span></span>

### <a name="create-a-vpn-gateway"></a><span data-ttu-id="32ce2-215">Creare un gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-215">Create a VPN gateway</span></span>

<span data-ttu-id="32ce2-216">Il tipo di gateway VPN che verrà creato dipende dall'architettura corrente.</span><span class="sxs-lookup"><span data-stu-id="32ce2-216">The type of VPN gateway you create will depend on your architecture.</span></span> <span data-ttu-id="32ce2-217">Le opzioni sono:</span><span class="sxs-lookup"><span data-stu-id="32ce2-217">Options are:</span></span>

- <span data-ttu-id="32ce2-218">RouteBased (Basato su route)</span><span class="sxs-lookup"><span data-stu-id="32ce2-218">RouteBased</span></span>

    <span data-ttu-id="32ce2-219">I dispositivi VPN basati su route usano selettori di traffico any-to-any (jolly) e consentono alle tabelle di routing/inoltro di indirizzare il traffico a tunnel IPsec diversi.</span><span class="sxs-lookup"><span data-stu-id="32ce2-219">Route-based VPN devices use any-to-any (wildcard) traffic selectors, and let routing/forwarding tables direct traffic to different IPsec tunnels.</span></span> <span data-ttu-id="32ce2-220">Le connessioni basate su route vengono in genere create su piattaforme router in cui ogni tunnel IPsec è modellato come interfaccia di rete o interfaccia di tunnel virtuale.</span><span class="sxs-lookup"><span data-stu-id="32ce2-220">Route-based connections are typically built on router platforms where each IPsec tunnel is modeled as a network interface or VTI (virtual tunnel interface).</span></span>

- <span data-ttu-id="32ce2-221">PolicyBased (Basato su criteri)</span><span class="sxs-lookup"><span data-stu-id="32ce2-221">PolicyBased</span></span>

    <span data-ttu-id="32ce2-222">I dispositivi VPN basati su criteri usano le combinazioni di prefissi di entrambe le reti per definire come crittografare/decrittografare il traffico tramite i tunnel IPsec.</span><span class="sxs-lookup"><span data-stu-id="32ce2-222">Policy-based VPN devices use the combinations of prefixes from both networks to define how traffic is encrypted/decrypted through IPsec tunnels.</span></span> <span data-ttu-id="32ce2-223">Una connessione basata su criteri viene in genere creata su dispositivi firewall che eseguono il filtro dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="32ce2-223">A policy-based connection is typically built on firewall devices that perform packet filtering.</span></span> <span data-ttu-id="32ce2-224">La crittografia e la decrittografia dei tunnel IPsec vengono aggiunte al filtro dei pacchetti e al motore di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="32ce2-224">IPsec tunnel encryption and decryption are added to the packet filtering and processing engine.</span></span>

## <a name="set-up-a-vpn-gateway"></a><span data-ttu-id="32ce2-225">Configurare un gateway VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-225">Set up a VPN gateway</span></span>

<span data-ttu-id="32ce2-226">La procedura da eseguire dipende dal tipo di gateway VPN che viene installato.</span><span class="sxs-lookup"><span data-stu-id="32ce2-226">The steps you need to take will depend on the type of VPN gateway that you are installing.</span></span> <span data-ttu-id="32ce2-227">Ad esempio, per creare un gateway VPN da punto a sito con il portale di Azure è necessario eseguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="32ce2-227">For example, to create a point-to-site VPN gateway by using the Azure portal, you would carry out the following steps:</span></span>

1. <span data-ttu-id="32ce2-228">Creare una rete virtuale</span><span class="sxs-lookup"><span data-stu-id="32ce2-228">Create a virtual network</span></span>

2. <span data-ttu-id="32ce2-229">Aggiungere una subnet del gateway</span><span class="sxs-lookup"><span data-stu-id="32ce2-229">Add a gateway subnet</span></span>

3. <span data-ttu-id="32ce2-230">Specificare un server DNS (facoltativo)</span><span class="sxs-lookup"><span data-stu-id="32ce2-230">Specify a DNS server (optional)</span></span>

4. <span data-ttu-id="32ce2-231">Creare un gateway di rete virtuale</span><span class="sxs-lookup"><span data-stu-id="32ce2-231">Create a virtual network gateway</span></span>

5. <span data-ttu-id="32ce2-232">Generare i certificati</span><span class="sxs-lookup"><span data-stu-id="32ce2-232">Generate certificates</span></span>

6. <span data-ttu-id="32ce2-233">Aggiungere il pool di indirizzi client</span><span class="sxs-lookup"><span data-stu-id="32ce2-233">Add the client address pool</span></span>

7. <span data-ttu-id="32ce2-234">Configurare il tipo di tunnel</span><span class="sxs-lookup"><span data-stu-id="32ce2-234">Configure the tunnel type</span></span>

8. <span data-ttu-id="32ce2-235">Configurare il tipo di autenticazione</span><span class="sxs-lookup"><span data-stu-id="32ce2-235">Configure the authentication type</span></span>

9. <span data-ttu-id="32ce2-236">Caricare i dati del certificato pubblico per il certificato radice</span><span class="sxs-lookup"><span data-stu-id="32ce2-236">Upload the root certificate public certificate data</span></span>

10. <span data-ttu-id="32ce2-237">Installare un certificato client esportato</span><span class="sxs-lookup"><span data-stu-id="32ce2-237">Install an exported client certificate</span></span>

11. <span data-ttu-id="32ce2-238">Generare e installare il pacchetto di configurazione del client VPN</span><span class="sxs-lookup"><span data-stu-id="32ce2-238">Generate and install the VPN client configuration package</span></span>

12. <span data-ttu-id="32ce2-239">Connettersi ad Azure</span><span class="sxs-lookup"><span data-stu-id="32ce2-239">Connect to Azure</span></span>

<span data-ttu-id="32ce2-240">Poiché sono disponibili numerosi percorsi di configurazione per i gateway VPN di Azure, ognuno dei quali con più opzioni, non è possibile illustrare ogni tipo di configurazione in questo corso.</span><span class="sxs-lookup"><span data-stu-id="32ce2-240">As there are several configuration paths with Azure VPN gateways, each with multiple options, it is not possible to cover every setup in this course.</span></span> <span data-ttu-id="32ce2-241">Per altre informazioni, vedere la sezione Risorse aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="32ce2-241">For more information, see the Additional Resources section.</span></span>

## <a name="configure-the-gateway"></a><span data-ttu-id="32ce2-242">Configurare il gateway</span><span class="sxs-lookup"><span data-stu-id="32ce2-242">Configure the gateway</span></span>

<span data-ttu-id="32ce2-243">Dopo aver creato il gateway è necessario configurarlo.</span><span class="sxs-lookup"><span data-stu-id="32ce2-243">Once your gateway is created, you'll need to configure it.</span></span>  <span data-ttu-id="32ce2-244">Sarà necessario specificare numerose impostazioni di configurazione, ad esempio nome, posizione, server DNS e così via. Queste impostazioni verranno esaminate più in dettaglio nell'esercizio.</span><span class="sxs-lookup"><span data-stu-id="32ce2-244">There are several configuration settings you will need to provide, such as the name, location, DNS server, etc. We will go into these in more detail in the exercise.</span></span>

## <a name="summary"></a><span data-ttu-id="32ce2-245">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="32ce2-245">Summary</span></span>

<span data-ttu-id="32ce2-246">I gateway VPN di Azure sono un componente delle reti virtuali di Azure che abilita le connessioni da punto a sito, da sito a sito o da rete a rete.</span><span class="sxs-lookup"><span data-stu-id="32ce2-246">Azure VPN gateways are a component in Azure virtual networks that enable point-to-site, site-to-site, or network-to-network connections.</span></span> <span data-ttu-id="32ce2-247">I gateway VPN di Azure consentono ai singoli computer client di connettersi alle risorse in Azure, di estendere le reti locali in Azure o di agevolare le connessioni tra reti virtuali in aree e sottoscrizioni diverse.</span><span class="sxs-lookup"><span data-stu-id="32ce2-247">Azure VPN gateways enable individual client computers to connect to resources in Azure, extend on-premises networks into Azure, or facilitate connections between virtual networks in different regions and subscriptions.</span></span>
